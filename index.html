<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Notes Clips</title>
	<link rel="icon" type="image/png" href="https://i.ibb.co/DyFR6nh/icon.png">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
   
   <style>
/* CSS Variables for consistent theming */
:root {
  --primary: #0078d4;
  --primary-dark: #106ebe;
  --primary-light: #50b6ff;
  --secondary: #6b6b6b;
  --success: #107c10;
  --warning: #ffb900;
  --danger: #d13438;
  --background: #f3f2f1;
  --surface: #ffffff;
  --surface-secondary: #faf9f8;
  --text-primary: #323130;
  --text-secondary: #605e5c;
  --text-tertiary: #a19f9d;
  --border: #edebe9;
  --border-focus: #0078d4;
  --shadow: 0 1.6px 3.6px 0 rgba(0, 0, 0, 0.132), 0 0.3px 0.9px 0 rgba(0, 0, 0, 0.108);
  --shadow-lg: 0 6.4px 14.4px 0 rgba(0, 0, 0, 0.132), 0 1.2px 3.6px 0 rgba(0, 0, 0, 0.108);
  --shadow-xl: 0 25.6px 57.6px 0 rgba(0, 0, 0, 0.22), 0 4.8px 14.4px 0 rgba(0, 0, 0, 0.18);
  --radius: 4px;
  --radius-lg: 8px;
  --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  --transition-fast: all 0.15s cubic-bezier(0.4, 0, 0.2, 1);
  --blur: blur(10px);
  --glow: 0 0 20px rgba(0, 120, 212, 0.3);
}

/* Dark theme variables */
body.dark-theme {
  --background: #1e1e1e;
  --surface: #2d2d2d;
  --surface-secondary: #252525;
  --text-primary: #ffffff;
  --text-secondary: #cccccc;
  --text-tertiary: #8a8886;
  --border: #3e3e3e;
  --border-focus: #50b6ff;
  --shadow: 0 1.6px 3.6px 0 rgba(0, 0, 0, 0.32), 0 0.3px 0.9px 0 rgba(0, 0, 0, 0.28);
  --shadow-lg: 0 6.4px 14.4px 0 rgba(0, 0, 0, 0.32), 0 1.2px 3.6px 0 rgba(0, 0, 0, 0.28);
  --glow: 0 0 20px rgba(80, 182, 255, 0.3);
}

/* Gray theme variables */
body.gray-theme {
  --background: #2a2a2a;
  --surface: #3a3a3a;
  --surface-secondary: #2f2f2f;
  --text-primary: #f0f0f0;
  --text-secondary: #c0c0c0;
  --text-tertiary: #8a8886;
  --border: #4a4a4a;
  --border-focus: #50b6ff;
  --shadow: 0 1.6px 3.6px 0 rgba(0, 0, 0, 0.32), 0 0.3px 0.9px 0 rgba(0, 0, 0, 0.28);
  --shadow-lg: 0 6.4px 14.4px 0 rgba(0, 0, 0, 0.32), 0 1.2px 3.6px 0 rgba(0, 0, 0, 0.28);
}

/* Base styles */
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: 'Inter', 'Segoe UI', sans-serif;
  background-color: var(--background);
  color: var(--text-primary);
  line-height: 1.5;
  transition: var(--transition);
  overflow-x: hidden;
}

.container {
  max-width: 1400px;
  margin: 0 auto;
  padding: 0 20px;
}

/* Loading overlay */
.loading-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(255, 255, 255, 0.9);
  backdrop-filter: var(--blur);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 9999;
  transition: var(--transition);
}

.dark-theme .loading-overlay {
  background-color: rgba(30, 30, 30, 0.9);
}

.gray-theme .loading-overlay {
  background-color: rgba(42, 42, 42, 0.9);
}

.loading-dots {
  display: flex;
  gap: 8px;
}

.dot {
  width: 12px;
  height: 12px;
  border-radius: 50%;
  background-color: var(--primary);
  animation: pulse 1.5s infinite ease-in-out;
}

.dot:nth-child(2) {
  animation-delay: 0.2s;
}

.dot:nth-child(3) {
  animation-delay: 0.4s;
}

@keyframes pulse {
  0%, 100% {
    transform: scale(0.8);
    opacity: 0.5;
  }
  50% {
    transform: scale(1.2);
    opacity: 1;
  }
}

/* Login container */
.login-container {
  min-height: 100vh;
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 20px;
  background: var(--background);
}

.login-card {
  background-color: var(--surface);
  border-radius: var(--radius-lg);
  box-shadow: var(--shadow-xl);
  padding: 40px;
  width: 100%;
  max-width: 440px;
  position: relative;
  overflow: hidden;
  transition: var(--transition);
  transform: translateY(20px);
  opacity: 0;
}

.login-card.active {
  transform: translateY(0);
  opacity: 1;
}

.login-card::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 4px;
  background: linear-gradient(90deg, var(--primary), var(--primary-light));
}

.login-logo {
  text-align: center;
  margin-bottom: 20px;
}

.login-logo i {
  font-size: 48px;
  color: var(--primary);
  background: linear-gradient(135deg, var(--primary), var(--primary-light));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  filter: drop-shadow(0 0 10px rgba(0, 120, 212, 0.3));
}

.login-title {
  text-align: center;
  font-size: 28px;
  font-weight: 600;
  margin-bottom: 8px;
  color: var(--text-primary);
}

.login-subtitle {
  text-align: center;
  color: var(--text-secondary);
  margin-bottom: 30px;
  font-size: 16px;
}

.login-form {
  transition: var(--transition);
}

.login-form.visible {
  display: block;
  animation: fadeIn 0.3s ease-out;
}

.login-form.hidden {
  display: none;
}

@keyframes fadeIn {
  from {
    opacity: 0;
    transform: translateY(10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* Form elements */
.form-group {
  margin-bottom: 20px;
}

.form-group label {
  display: block;
  margin-bottom: 6px;
  font-weight: 500;
  color: var(--text-primary);
  font-size: 14px;
}

.form-input {
  width: 100%;
  padding: 12px 16px;
  border: 1px solid var(--border);
  border-radius: var(--radius);
  background-color: var(--surface);
  color: var(--text-primary);
  font-size: 16px;
  transition: var(--transition-fast);
  outline: none;
}

.form-input:focus {
  border-color: var(--primary);
  box-shadow: 0 0 0 2px rgba(0, 120, 212, 0.2);
}

.input-with-icon {
  position: relative;
}

.password-toggle {
  position: absolute;
  right: 12px;
  top: 50%;
  transform: translateY(-50%);
  background: none;
  border: none;
  color: var(--text-tertiary);
  cursor: pointer;
  transition: var(--transition-fast);
}

.password-toggle:hover {
  color: var(--text-secondary);
}

/* Buttons */
.btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  padding: 12px 24px;
  border: none;
  border-radius: var(--radius);
  font-weight: 500;
  font-size: 14px;
  cursor: pointer;
  transition: var(--transition);
  text-decoration: none;
  position: relative;
  overflow: hidden;
}

.btn::before {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
  transition: left 0.5s;
}

.btn:hover::before {
  left: 100%;
}

.btn-primary {
  background-color: var(--primary);
  color: white;
  width: 100%;
}

.btn-primary:hover {
  background-color: var(--primary-dark);
  box-shadow: var(--glow);
}

.btn-secondary {
  background-color: var(--surface-secondary);
  color: var(--text-primary);
  border: 1px solid var(--border);
}

.btn-secondary:hover {
  background-color: var(--border);
}

.btn-danger {
  background-color: var(--danger);
  color: white;
}

.btn-danger:hover {
  background-color: #a4262c;
}

.btn-success {
  background-color: var(--success);
  color: white;
}

.btn-success:hover {
  background-color: #0d6b0d;
}

.button-success {
  background-color: var(--success) !important;
}

/* Status messages */
.status-message {
  padding: 12px;
  border-radius: var(--radius);
  margin-top: 16px;
  font-size: 14px;
  display: none;
}

.status-success {
  background-color: rgba(16, 124, 16, 0.1);
  color: var(--success);
  border: 1px solid rgba(16, 124, 16, 0.2);
}

.status-error {
  background-color: rgba(209, 52, 56, 0.1);
  color: var(--danger);
  border: 1px solid rgba(209, 52, 56, 0.2);
}

/* Dashboard */
.header {
  padding: 0px 0;
  opacity: 0;
  font-size: 0.1px; /* or 1px, 0.5px, etc. */
  margin-bottom: 0px;
}

.header h1 {
  font-size: 28px;
  font-weight: 600;
  display: flex;
  align-items: center;
  gap: 12px;
  color: var(--text-primary);
}

.header h1 i {
  color: var(--primary);
  background: linear-gradient(135deg, var(--primary), var(--primary-light));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
}

.dashboard-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 30px;
  flex-wrap: wrap;
  gap: 20px;
}



.reminder-notification {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 12px 20px;
  background-color: var(--surface);
  border-radius: var(--radius);
  box-shadow: var(--shadow);
  cursor: pointer;
  transition: var(--transition);
  position: relative;
  overflow: hidden;
}

.reminder-notification::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  width: 4px;
  height: 100%;
  background-color: var(--primary);
  transition: var(--transition);
}

.reminder-notification.active {
  box-shadow: var(--glow);
}

.reminder-notification.active::before {
  background-color: var(--warning);
}

.reminder-notification.grayed {
  opacity: 0.7;
}

.reminder-notification:hover {
  transform: translateY(-2px);
  box-shadow: var(--shadow-lg);
}

.notification-icon {
  position: relative;
  color: var(--text-secondary);
}

.notification-count {
  position: absolute;
  top: -8px;
  right: -8px;
  background-color: var(--danger);
  color: white;
  border-radius: 50%;
  width: 20px;
  height: 20px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 12px;
  font-weight: 600;
}

.notification-text {
  font-weight: 500;
  color: var(--text-primary);
}

.notification-arrow {
  color: var(--text-tertiary);
  transition: var(--transition);
}

.reminder-notification.expanded .notification-arrow {
  transform: rotate(180deg);
}

/* Tabs */
.tabs {
  display: flex;
  gap: 4px;
  margin-bottom: 30px;
  background-color: var(--surface);
  padding: 8px;
  border-radius: var(--radius);
  box-shadow: var(--shadow);
  overflow-x: auto;
}

.tab {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 12px 20px;
  border-radius: var(--radius);
  cursor: pointer;
  transition: var(--transition);
  color: var(--text-secondary);
  font-weight: 500;
  white-space: nowrap;
}

.tab:hover {
  background-color: var(--surface-secondary);
  color: var(--text-primary);
}

.tab.active {
  background-color: var(--primary);
  color: white;
  box-shadow: var(--shadow);
}

.tab-content {
  display: none;
}

.tab-content.active {
  display: block;
  animation: fadeIn 0.3s ease-out;
}

.tab-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 24px;
}

.tab-header h2 {
  font-size: 24px;
  font-weight: 600;
  color: var(--text-primary);
}

.add-btn {
  width: 48px;
  height: 48px;
  border-radius: 50%;
  background-color: var(--primary);
  color: white;
  border: none;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: var(--transition);
  box-shadow: var(--shadow);
}

.add-btn:hover {
  background-color: var(--primary-dark);
  transform: scale(1.05);
  box-shadow: var(--glow);
}

/* Cards */
.cards-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
  gap: 24px;
}

.card {
  background-color: var(--surface);
  border-radius: var(--radius-lg);
  box-shadow: var(--shadow);
  padding: 24px;
  transition: var(--transition);
  position: relative;
  overflow: hidden;
}

.card::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 4px;
  background: linear-gradient(90deg, var(--primary), transparent);
  opacity: 0;
  transition: var(--transition);
}

.card:hover {
  transform: translateY(-4px);
  box-shadow: var(--shadow-lg);
}

.card:hover::before {
  opacity: 1;
}

.card-header {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  margin-bottom: 16px;
}

.card-title {
  font-size: 18px;
  font-weight: 600;
  color: var(--text-primary);
}

.card-actions {
  display: flex;
  gap: 8px;
}

.action-btn {
  width: 32px;
  height: 32px;
  border-radius: var(--radius);
  display: flex;
  align-items: center;
  justify-content: center;
  background: none;
  border: none;
  color: var(--text-tertiary);
  cursor: pointer;
  transition: var(--transition-fast);
}

.action-btn:hover {
  background-color: var(--surface-secondary);
  color: var(--text-primary);
}

.card-field {
  margin-bottom: 16px;
}

.field-label {
  font-size: 14px;
  color: var(--text-secondary);
  margin-bottom: 4px;
}

.field-value {
  display: flex;
  align-items: center;
  justify-content: space-between;
  background-color: var(--surface-secondary);
  padding: 10px 12px;
  border-radius: var(--radius);
  cursor: pointer;
  transition: var(--transition-fast);
}

.field-value:hover {
  background-color: var(--border);
}

.field-text {
  font-weight: 500;
  color: var(--text-primary);
  word-break: break-all;
}

.copy-btn {
  background: none;
  border: none;
  color: var(--text-tertiary);
  cursor: pointer;
  transition: var(--transition-fast);
  padding: 4px;
  border-radius: var(--radius);
}

.copy-btn:hover {
  background-color: var(--surface);
  color: var(--text-primary);
}

/* Note cards */
.note-card {
  background-color: var(--surface);
  border-radius: var(--radius-lg);
  box-shadow: var(--shadow);
  padding: 24px;
  transition: var(--transition);
  position: relative;
  overflow: hidden;
  cursor: pointer;
}

.note-card::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 6px;
  transition: var(--transition);
}

.note-card.default::before {
  background-color: var(--primary);
}

.note-card.yellow::before {
  background-color: #ffb900;
}

.note-card.green::before {
  background-color: #107c10;
}

.note-card.pink::before {
  background-color: #e3008c;
}

.note-card.purple::before {
  background-color: #744da9;
}

.note-card.blue::before {
  background-color: #0078d4;
}

.note-card:hover {
  transform: translateY(-4px);
  box-shadow: var(--shadow-lg);
}

.note-title {
  font-size: 18px;
  font-weight: 600;
  margin-bottom: 12px;
  color: var(--text-primary);
}

.note-content {
  color: var(--text-secondary);
  line-height: 1.6;
  max-height: 120px;
  overflow: hidden;
  position: relative;
}

.note-content::after {
  content: '';
  position: absolute;
  bottom: 0;
  left: 0;
  width: 100%;
  height: 40px;
  background: linear-gradient(transparent, var(--surface));
  opacity: 1;
  transition: var(--transition);
}

.note-content.expanded {
  max-height: none;
}

.note-content.expanded::after {
  opacity: 0;
}

.read-more {
  color: var(--primary);
  font-weight: 500;
  margin-top: 12px;
  cursor: pointer;
  display: inline-block;
  transition: var(--transition-fast);
}

.read-more:hover {
  color: var(--primary-dark);
}

/* Empty state */
.empty-state {
  text-align: center;
  padding: 40px 20px;
  color: var(--text-tertiary);
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  min-height: 200px;
}

.empty-state i {
  font-size: 48px;
  margin-bottom: 16px;
  opacity: 0.5;
}

.empty-state h3 {
  font-size: 18px;
  margin-bottom: 8px;
  color: var(--text-secondary);
}

.empty-state p {
  font-size: 14px;
}

/* Modals */
.modal-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0, 0, 0, 0.4);
  backdrop-filter: var(--blur);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 1000;
  opacity: 0;
  visibility: hidden;
  transition: var(--transition);
}

.modal-overlay.active {
  opacity: 1;
  visibility: visible;
}

.modal {
  background-color: var(--surface);
  border-radius: var(--radius-lg);
  box-shadow: var(--shadow-xl);
  width: 90%;
  max-width: 500px;
  max-height: 90vh;
  overflow-y: auto;
  transform: scale(0.9);
  opacity: 0;
  transition: var(--transition);
}

.modal-overlay.active .modal {
  transform: scale(1);
  opacity: 1;
}

.modal-header {
  padding: 24px 24px 0;
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
}

.modal-title {
  font-size: 20px;
  font-weight: 600;
  color: var(--text-primary);
}

.close-modal {
  background: none;
  border: none;
  font-size: 24px;
  color: var(--text-tertiary);
  cursor: pointer;
  transition: var(--transition-fast);
  width: 32px;
  height: 32px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: var(--radius);
}

.close-modal:hover {
  background-color: var(--surface-secondary);
  color: var(--text-primary);
}

.modal-body {
  padding: 0 24px;
}

.modal-footer {
  padding: 20px 24px 24px;
  display: flex;
  justify-content: flex-end;
  gap: 12px;
  border-top: 1px solid var(--border);
  margin-top: 20px;
}

/* Color options */
.color-options {
  display: flex;
  gap: 12px;
  margin-top: 8px;
}

.color-option {
  width: 32px;
  height: 32px;
  border-radius: 50%;
  cursor: pointer;
  transition: var(--transition);
  border: 2px solid transparent;
  position: relative;
}

.color-option::after {
  content: '';
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%) scale(0);
  width: 16px;
  height: 16px;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='white'%3E%3Cpath d='M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z'/%3E%3C/svg%3E");
  background-size: contain;
  transition: var(--transition);
}

.color-option.selected::after {
  transform: translate(-50%, -50%) scale(1);
}

.color-option.selected {
  transform: scale(1.1);
  box-shadow: 0 0 0 2px var(--surface), 0 0 0 4px var(--primary);
}

.color-default {
  background-color: var(--primary);
}

.color-yellow {
  background-color: #ffb900;
}

.color-green {
  background-color: #107c10;
}

.color-pink {
  background-color: #e3008c;
}

.color-purple {
  background-color: #744da9;
}

.color-blue {
  background-color: #0078d4;
}

/* Confirmation modal */
.confirmation-modal {
  max-width: 450px;
  min-height: 180px;
  display: flex;
  flex-direction: column;
  justify-content: center;
}

.confirmation-text {
  text-align: center;
  margin-bottom: 24px;
  color: var(--text-primary);
  font-size: 18px;
  padding: 0 16px;
}

.confirmation-actions {
  display: flex;
  justify-content: center;
  gap: 12px;
  padding: 0 16px 16px;
}

/* Note popup */
.note-popup {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0, 0, 0, 0.4);
  backdrop-filter: var(--blur);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 1000;
  opacity: 0;
  visibility: hidden;
  transition: var(--transition);
}

.note-popup.active {
  opacity: 1;
  visibility: visible;
}

.note-popup-content {
  background-color: var(--surface);
  border-radius: var(--radius-lg);
  box-shadow: var(--shadow-xl);
  width: 90%;
  max-width: 600px;
  max-height: 80vh;
  overflow-y: auto;
  padding: 24px;
  position: relative;
  transform: scale(0.9);
  opacity: 0;
  transition: var(--transition);
}

.note-popup.active .note-popup-content {
  transform: scale(1);
  opacity: 1;
}

.note-popup-close {
  position: absolute;
  top: 16px;
  right: 16px;
  background: none;
  border: none;
  font-size: 24px;
  color: var(--text-tertiary);
  cursor: pointer;
  transition: var(--transition-fast);
  width: 32px;
  height: 32px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: var(--radius);
}

.note-popup-close:hover {
  background-color: var(--surface-secondary);
  color: var(--text-primary);
}

.note-popup-title {
  font-size: 24px;
  font-weight: 600;
  margin-bottom: 16px;
  color: var(--text-primary);
  padding-right: 40px;
}

.note-popup-content-text {
  color: var(--text-secondary);
  line-height: 1.6;
  white-space: pre-line;
}

/* Clipboard notification */
.clipboard-notification {
  position: fixed;
  top: 24px;
  right: 24px;
  background-color: var(--surface);
  border-radius: var(--radius);
  box-shadow: var(--shadow-lg);
  padding: 16px 20px;
  display: flex;
  align-items: center;
  gap: 12px;
  z-index: 1100;
  transform: translateX(150%);
  transition: var(--transition);
  border-left: 4px solid var(--success);
}

.clipboard-notification.success {
  border-left-color: var(--success);
}

.clipboard-notification.error {
  border-left-color: var(--danger);
}

.clipboard-notification.show {
  transform: translateX(0);
}

/* Reminders */
.reminders-container {
  background-color: var(--surface);
  border-radius: var(--radius-lg);
  box-shadow: var(--shadow);
  overflow: hidden;
}

.reminders-header {
  padding: 20px 24px;
  background-color: var(--surface-secondary);
  color: var(--text-secondary);
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 14px;
}

.reminders-tabs {
  display: flex;
  border-bottom: 1px solid var(--border);
}

.reminder-tab {
  padding: 16px 24px;
  cursor: pointer;
  transition: var(--transition);
  color: var(--text-secondary);
  font-weight: 500;
  border-bottom: 2px solid transparent;
}

.reminder-tab:hover {
  color: var(--text-primary);
  background-color: var(--surface-secondary);
}

.reminder-tab.active {
  color: var(--primary);
  border-bottom-color: var(--primary);
}

.reminders-list {
  padding: 24px;
}

.reminder-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 16px;
  border-radius: var(--radius);
  transition: var(--transition);
  margin-bottom: 12px;
  border: 1px solid var(--border);
}

.reminder-item:hover {
  background-color: var(--surface-secondary);
  transform: translateY(-2px);
  box-shadow: var(--shadow);
}

.reminder-content {
  flex: 1;
}

.reminder-title {
  font-weight: 500;
  color: var(--text-primary);
  margin-bottom: 4px;
}

.reminder-remarks {
  color: var(--text-secondary);
  font-size: 14px;
  margin-bottom: 4px;
}

.reminder-date {
  color: var(--text-tertiary);
  font-size: 12px;
}

.reminder-actions {
  display: flex;
  gap: 8px;
}

/* History */
.history-item {
  background-color: var(--surface);
  border-radius: var(--radius);
  box-shadow: var(--shadow);
  padding: 20px;
  margin-bottom: 16px;
  transition: var(--transition);
}

.history-item:hover {
  transform: translateY(-2px);
  box-shadow: var(--shadow-lg);
}

.history-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 8px;
}

.history-action {
  font-weight: 500;
  color: var(--text-primary);
}

.history-time {
  color: var(--text-tertiary);
  font-size: 14px;
}

.history-details {
  color: var(--text-secondary);
  font-size: 14px;
}

.view-more-btn {
  background: none;
  border: none;
  color: var(--primary);
  font-size: 14px;
  cursor: pointer;
  margin-top: 8px;
  display: flex;
  align-items: center;
  gap: 4px;
  transition: var(--transition-fast);
}

.view-more-btn:hover {
  color: var(--primary-dark);
}

.history-details-full {
  margin-top: 12px;
  padding: 12px;
  background-color: var(--surface-secondary);
  border-radius: var(--radius);
  white-space: pre-line;
  font-size: 14px;
  color: var(--text-secondary);
  display: none;
}

.history-details-full.show {
  display: block;
  animation: fadeIn 0.3s ease-out;
}

.load-more-btn {
  display: block;
  margin: 30px auto 0;
  padding: 12px 24px;
  background-color: var(--surface);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  color: var(--text-primary);
  font-weight: 500;
  cursor: pointer;
  transition: var(--transition);
}

.load-more-btn:hover {
  background-color: var(--surface-secondary);
  box-shadow: var(--shadow);
}

/* Settings */
.user-greeting {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 20px;
  background-color: var(--surface);
  border-radius: var(--radius);
  box-shadow: var(--shadow);
  margin-bottom: 30px;
}

.user-greeting i {
  font-size: 24px;
  color: var(--primary);
}

.user-greeting span {
  font-size: 18px;
  font-weight: 500;
  color: var(--text-primary);
}

.settings-section {
  background-color: var(--surface);
  border-radius: var(--radius-lg);
  box-shadow: var(--shadow);
  padding: 24px;
  margin-bottom: 24px;
}

.settings-title {
  display: flex;
  align-items: center;
  gap: 12px;
  font-size: 18px;
  font-weight: 600;
  margin-bottom: 20px;
  color: var(--text-primary);
}

.settings-title i {
  color: var(--primary);
}

.settings-option {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 16px 0;
  border-bottom: 1px solid var(--border);
}

.settings-option:last-child {
  border-bottom: none;
}

.option-label {
  flex: 1;
}

.option-title {
  display: block;
  font-weight: 500;
  color: var(--text-primary);
  margin-bottom: 4px;
}

.option-desc {
  display: block;
  font-size: 14px;
  color: var(--text-secondary);
}

/* Toggle switch */
.toggle-switch {
  position: relative;
  display: inline-block;
  width: 52px;
  height: 28px;
}

.toggle-switch input {
  opacity: 0;
  width: 0;
  height: 0;
}

.slider {
  position: absolute;
  cursor: pointer;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: var(--border);
  transition: var(--transition);
  border-radius: 34px;
}

.slider:before {
  position: absolute;
  content: "";
  height: 20px;
  width: 20px;
  left: 4px;
  bottom: 4px;
  background-color: white;
  transition: var(--transition);
  border-radius: 50%;
}

input:checked + .slider {
  background-color: var(--primary);
}

input:checked + .slider:before {
  transform: translateX(24px);
}

/* Clipboard */
.clipboard-container {
  background-color: var(--surface);
  border-radius: var(--radius-lg);
  box-shadow: var(--shadow);
  padding: 24px;
}

.clipboard-actions {
  display: flex;
  gap: 16px;
  margin-bottom: 24px;
  flex-wrap: wrap;
}

.clipboard-actions .btn {
  flex: 1;
  min-width: 200px;
  padding: 14px 24px;
  font-size: 16px;
  background-color: #4CAF50;
  border: none;
  border-radius: var(--radius);
  color: white;
  cursor: pointer;
  transition: var(--transition);
}

.clipboard-actions .btn:hover {
  background-color: #45a049;
  transform: translateY(-2px);
  box-shadow: 0 4px 8px rgba(0,0,0,0.1);
}

.clipboard-actions .btn.btn-success {
  background-color: #4CAF50;
}

.clipboard-actions .btn.btn-danger {
  background-color: #f44336;
}

.clipboard-actions .btn.btn-danger:hover {
  background-color: #d32f2f;
}

.clipboard-preview {
  border: 1px solid var(--border);
  border-radius: var(--radius);
  overflow: hidden;
}

.clipboard-preview-title {
  padding: 16px 20px;
  background-color: var(--surface-secondary);
  font-size: 16px;
  font-weight: 500;
  color: var(--text-primary);
  border-bottom: 1px solid var(--border);
}

.clipboard-preview-content {
  padding: 20px;
  min-height: 200px;
  color: var(--text-secondary);
  white-space: pre-wrap;
  background-color: var(--surface);
  display: flex;
  align-items: center;
  justify-content: center;
  text-align: center;
}

.clipboard-preview-content.has-data {
  color: var(--text-primary);
  justify-content: flex-start;
  align-items: flex-start;
}

/* Footer */
footer {
  text-align: center;
  padding: 30px 0;
  margin-top: 60px;
  color: var(--text-tertiary);
  font-size: 14px;
  border-top: 1px solid var(--border);
}

/* Animations */
.animate-pulse {
  animation: pulse 0.5s ease-in-out;
}

/* Notes Sub-tabs */
.notes-sub-tabs {
  display: flex;
  gap: 4px;
  margin-bottom: 24px;
  background-color: var(--surface);
  padding: 8px;
  border-radius: var(--radius);
  box-shadow: var(--shadow);
  overflow-x: auto;
}

.note-sub-tab {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 12px 20px;
  border-radius: var(--radius);
  cursor: pointer;
  transition: var(--transition);
  color: var(--text-secondary);
  font-weight: 500;
  white-space: nowrap;
}

.note-sub-tab:hover {
  background-color: var(--surface-secondary);
  color: var(--text-primary);
}

.note-sub-tab.active {
  background-color: var(--primary);
  color: white;
  box-shadow: var(--shadow);
}

.note-sub-content {
  display: none;
}

.note-sub-content.active {
  display: block;
  animation: fadeIn 0.3s ease-out;
}

/* Responsive design */
@media (max-width: 768px) {
  .container {
    padding: 0 16px;
  }
  
  .login-card {
    padding: 24px;
  }
  
  .tabs {
    overflow-x: auto;
    padding: 4px;
  }
  
  .tab {
    padding: 10px 16px;
    font-size: 14px;
  }
  
  .cards-grid {
    grid-template-columns: 1fr;
  }
  
  .dashboard-header {
    flex-direction: column;
    align-items: flex-start;
  }
  
  .modal {
    width: 95%;
    margin: 20px;
  }
  
  .confirmation-actions {
    flex-direction: column;
  }
  
  .clipboard-actions {
    flex-direction: column;
  }
  
  .clipboard-actions .btn {
    min-width: auto;
  }
}

@media (max-width: 480px) {
  .login-card {
    padding: 20px;
  }
  
  .tab-header {
    flex-direction: column;
    align-items: flex-start;
    gap: 16px;
  }
  
  .modal-header,
  .modal-body,
  .modal-footer {
    padding-left: 20px;
    padding-right: 20px;
  }
  
  .settings-option {
    flex-direction: column;
    align-items: flex-start;
    gap: 12px;
  }
}

/* Workflow Tab Styles */
.workflow-tools-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
  gap: 16px;
  margin-top: 20px;
}

.workflow-tool-card {
  background-color: var(--surface);
  border-radius: var(--radius-lg);
  padding: 16px;
  box-shadow: var(--shadow);
  text-align: center;
  cursor: pointer;
  position: relative;
  border: 2px solid transparent;
  transition: var(--transition);
  height: 100%;
  display: flex;
  flex-direction: column;
  justify-content: space-between;
}

.workflow-tool-card:hover {
  transform: translateY(-3px);
  box-shadow: var(--shadow-lg);
  border-color: var(--primary);
}

.workflow-tool-icon {
  font-size: 2rem;
  margin-bottom: 12px;
  color: var(--primary);
}

.workflow-tool-title {
  font-size: 1rem;
  margin-bottom: 8px;
  font-weight: 600;
  color: var(--text-primary);
}

.workflow-tool-desc {
  font-size: 0.8rem;
  opacity: 0.8;
  color: var(--text-secondary);
}

.workflow-date-info {
  background-color: var(--surface);
  border-radius: var(--radius-lg);
  box-shadow: var(--shadow);
  padding: 20px;
  margin-bottom: 24px;
}

.workflow-date-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 16px;
}

.workflow-date-item {
  display: flex;
  flex-direction: column;
  padding: 12px;
  background-color: var(--surface-secondary);
  border-radius: var(--radius);
  transition: var(--transition);
  position: relative;
  overflow: hidden;
}

.workflow-date-item::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  width: 6px;
  height: 100%;
}

.workflow-date-item.rollover::before {
  background-color: #e3008c;
}

.workflow-date-item.mbb::before {
  background-color: #0078d4;
}

.workflow-date-item.prepaid::before {
  background-color: #107c10;
}

.workflow-date-item.hunting::before {
  background-color: #744da9;
}

.workflow-date-item:hover {
  background-color: var(--border);
  transform: translateY(-2px);
}

.workflow-date-label {
  font-size: 0.85rem;
  color: var(--text-secondary);
  margin-bottom: 4px;
}

.workflow-date-value {
  font-size: 1rem;
  font-weight: 600;
  color: var(--text-primary);
}

.workflow-refresh-btn {
  background-color: var(--primary);
  color: white;
  border: none;
  border-radius: 50%;
  width: 36px;
  height: 36px;
  display: flex;
  justify-content: center;
  align-items: center;
  cursor: pointer;
  font-size: 1rem;
  box-shadow: var(--shadow);
  transition: var(--transition);
  margin-left: auto;
}

.workflow-refresh-btn:hover {
  transform: rotate(90deg);
  background-color: var(--primary-dark);
}

.workflow-date-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 16px;
}

.workflow-date-header h3 {
  font-size: 1.2rem;
  font-weight: 600;
  color: var(--text-primary);
}

/* Workflow Settings */
.workflow-settings {
  display: flex;
  justify-content: center;
  margin-top: 30px;
  padding: 15px;
  background-color: var(--surface);
  border-radius: var(--radius);
  box-shadow: var(--shadow);
  margin-bottom: 20px;
  cursor: pointer;
}

.workflow-settings-label {
  display: flex;
  align-items: center;
  gap: 10px;
  font-size: 0.9rem;
}

/* Dashboard Logo Center */
.dashboard-logo-center {
  display: flex;
  align-items: center;
  justify-content: center;
  flex: 1;
  margin: 0 20px;
}

.dashboard-logo-center h1 {
  font-size: 28px;
  font-weight: 600;
  display: flex;
  align-items: center;
  gap: 12px;
  color: var(--text-primary);
}

.dashboard-logo-center h1 i {
  color: var(--primary);
  background: linear-gradient(135deg, var(--primary), var(--primary-light));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
}

/* Settings button fixes */
.settings-option button {
  padding: 8px 16px !important;
  width: auto !important;
  min-width: 120px !important;
}

/* Button states for clipboard */
.btn-success {
  background-color: #4CAF50 !important;
}

.btn-success:hover {
  background-color: #45a049 !important;
}

.btn-danger {
  background-color: #f44336 !important;
}

.btn-danger:hover {
  background-color: #d32f2f !important;
}

.btn-success.button-success, .btn-danger.button-success {
  background-color: #4CAF50 !important;
}

.btn-success.button-success::after, .btn-danger.button-success::after {
  content: " ✓";
  font-weight: bold;
}

/* Remove Workflow Tools title */
.workflow-tab .tab-header h2 {
  display: none;
}
</style>
</head>
<body>
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-dots">
            <div class="dot"></div>
            <div class="dot"></div>
            <div class="dot"></div>
        </div>
    </div>

    <!-- Logout Confirmation Modal -->
    <div class="modal-overlay" id="logoutModal">
        <div class="modal confirmation-modal">
            <div class="modal-body">
                <p class="confirmation-text">Are you sure you want to sign out?</p>
                <div class="confirmation-actions">
                    <button class="btn btn-secondary" onclick="hideLogoutModal()">Cancel</button>
                    <button class="btn btn-danger" onclick="confirmLogout()">Sign Out</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Password Modal -->
    <div class="modal-overlay" id="passwordModal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title" id="passwordModalTitle">Add Password</h3>
                <button class="close-modal" id="closePasswordModal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="platform-name">This is password of:</label>
                    <input type="text" id="platform-name" class="form-input" placeholder="e.g., Gmail, Facebook" required>
                </div>
                <div class="form-group">
                    <label for="platform-username">Username:</label>
                    <input type="text" id="platform-username" class="form-input" placeholder="Add username (optional)">
                </div>
                <div class="form-group">
                    <label for="platform-password">Password:</label>
                    <div class="input-with-icon">
                        <input type="password" id="platform-password" class="form-input" placeholder="Add password" required>
                        <button type="button" class="password-toggle" id="platformPasswordToggle">
                            <i class="far fa-eye"></i>
                        </button>
                    </div>
                </div>
                <div class="form-group">
                    <button type="button" class="btn btn-secondary" id="addSecondPasswordBtn">+ Add 2nd Password</button>
                </div>
                <div class="form-group" id="secondPasswordGroup" style="display: none;">
                    <label for="platform-password2">Second Password:</label>
                    <div class="input-with-icon">
                        <input type="password" id="platform-password2" class="form-input" placeholder="Add second password (optional)">
                        <button type="button" class="password-toggle" id="platformPassword2Toggle">
                            <i class="far fa-eye"></i>
                        </button>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="cancelPasswordBtn">Cancel</button>
                <button class="btn btn-primary" id="savePasswordBtn">Save</button>
            </div>
        </div>
    </div>

    <!-- Note Modal -->
    <div class="modal-overlay" id="noteModal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title" id="noteModalTitle">Add Note</h3>
                <button class="close-modal" id="closeNoteModal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="note-title">Title:</label>
                    <input type="text" id="note-title" class="form-input" placeholder="Note title" required>
                </div>
                <div class="form-group">
                    <label for="note-content">Content:</label>
                    <textarea id="note-content" class="form-input" rows="5" placeholder="Write your note here..." required></textarea>
                </div>
                <div class="form-group">
                    <label>Color:</label>
                    <div class="color-options">
                        <div class="color-option color-default selected" data-color="default"></div>
                        <div class="color-option color-yellow" data-color="yellow"></div>
                        <div class="color-option color-green" data-color="green"></div>
                        <div class="color-option color-pink" data-color="pink"></div>
                        <div class="color-option color-purple" data-color="purple"></div>
                        <div class="color-option color-blue" data-color="blue"></div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="cancelNoteBtn">Cancel</button>
                <button class="btn btn-primary" id="saveNoteBtn">Save</button>
            </div>
        </div>
    </div>

    <!-- Change Password Modal -->
    <div class="modal-overlay" id="changePasswordModal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title">Change Password</h3>
                <button class="close-modal" id="closeChangePasswordModal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="current-password">Current Password:</label>
                    <div class="input-with-icon">
                        <input type="password" id="current-password" class="form-input" required>
                        <button type="button" class="password-toggle" id="currentPasswordToggle">
                            <i class="far fa-eye"></i>
                        </button>
                    </div>
                </div>
                <div class="form-group">
                    <label for="new-password">New Password:</label>
                    <div class="input-with-icon">
                        <input type="password" id="new-password" class="form-input" required>
                        <button type="button" class="password-toggle" id="newPasswordToggle">
                            <i class="far fa-eye"></i>
                        </button>
                    </div>
                </div>
                <div class="form-group">
                    <label for="confirm-new-password">Confirm New Password:</label>
                    <div class="input-with-icon">
                        <input type="password" id="confirm-new-password" class="form-input" required>
                        <button type="button" class="password-toggle" id="confirmNewPasswordToggle">
                            <i class="far fa-eye"></i>
                        </button>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="cancelChangePasswordBtn">Cancel</button>
                <button class="btn btn-primary" id="saveChangePasswordBtn">Change Password</button>
            </div>
        </div>
    </div>

    <!-- Confirmation Modal -->
    <div class="modal-overlay" id="confirmationModal">
        <div class="modal confirmation-modal">
            <div class="modal-body">
                <p class="confirmation-text" id="confirmationText">Are you sure you want to delete this item?</p>
                <div class="confirmation-actions">
                    <button class="btn btn-secondary" id="cancelConfirmationBtn">Cancel</button>
                    <button class="btn btn-danger" id="confirmActionBtn">Confirm</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Note Popup -->
    <div class="note-popup" id="notePopup">
        <div class="note-popup-content">
            <button class="note-popup-close" id="closeNotePopup">&times;</button>
            <h3 class="note-popup-title" id="notePopupTitle"></h3>
            <div class="note-popup-content-text" id="notePopupContent"></div>
        </div>
    </div>

    <!-- Reminder Modal -->
    <div class="modal-overlay" id="reminderModal">
        <div class="modal reminder-modal">
            <div class="modal-header">
                <h3 class="modal-title" id="reminderModalTitle">Add Reminder</h3>
                <button class="close-modal" id="closeReminderModal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="reminder-title">Title:</label>
                    <input type="text" id="reminder-title" class="form-input" placeholder="Reminder title" required>
                </div>
                <div class="form-group">
                    <label for="reminder-description">Description:</label>
                    <textarea id="reminder-description" class="form-input" rows="3" placeholder="Add description (optional)"></textarea>
                </div>
                <div class="form-group">
                    <label for="reminder-date">Date:</label>
                    <div class="date-picker">
                        <input type="date" id="reminder-date" class="form-input" required>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="cancelReminderBtn">Cancel</button>
                <button class="btn btn-primary" id="saveReminderBtn">Save</button>
            </div>
        </div>
    </div>

    <!-- Clipboard Notification -->
    <div class="clipboard-notification" id="clipboardNotification">
        <i class="fas fa-check-circle"></i>
        <span id="clipboardNotificationText">Clipboard content sent successfully!</span>
    </div>

    <div class="container">
        <!-- Login Container -->
        <div id="loginContainer">
            <div class="login-container">
                <div class="login-card" id="loginCard">
                    <div class="login-logo">
                        <i class="fas fa-clipboard-list"></i>
                    </div>
                    <h2 class="login-title">Notes Clips</h2>
                    <p class="login-subtitle">Secure Password & Notes Manager</p>
                    
                    <!-- Login Form -->
                    <div class="login-form visible" id="loginForm">
                        <div class="form-group">
                            <label for="login-identifier">Username or Email</label>
                            <input type="text" id="login-identifier" class="form-input" placeholder="Enter your username or email" required>
                        </div>
                        <div class="form-group">
                            <label for="login-password">Password</label>
                            <div class="input-with-icon">
                                <input type="password" id="login-password" class="form-input" placeholder="Enter your password" required>
                                <button type="button" class="password-toggle" id="loginPasswordToggle">
                                    <i class="far fa-eye"></i>
                                </button>
                            </div>
                        </div>
                        <button class="btn btn-primary" id="loginButton">
                            <i class="fas fa-sign-in-alt"></i> Sign In
                        </button>
                        <div class="status-message" id="loginStatus"></div>
                        
                        <div style="text-align: center; margin-top: 20px;">
                            <p style="color: var(--text-secondary);">Don't have an account? <a href="#" style="color: var(--primary); font-weight: 500; cursor: pointer;" id="showSignupLink">Create one!</a></p>
                        </div>
                    </div>

                    <!-- Signup Form (initially hidden) -->
                    <div class="login-form hidden" id="signupForm">
                        <div class="form-group">
                            <label for="signup-username">Username</label>
                            <input type="text" id="signup-username" class="form-input" placeholder="Choose a username" required>
                        </div>
                        <div class="form-group">
                            <label for="signup-email">Email (optional)</label>
                            <input type="email" id="signup-email" class="form-input" placeholder="Your email address">
                        </div>
                        <div class="form-group">
                            <label for="signup-password">Password</label>
                            <div class="input-with-icon">
                                <input type="password" id="signup-password" class="form-input" placeholder="Create a password" required>
                                <button type="button" class="password-toggle" id="signupPasswordToggle">
                                    <i class="far fa-eye"></i>
                                </button>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="signup-confirm-password">Confirm Password</label>
                            <div class="input-with-icon">
                                <input type="password" id="signup-confirm-password" class="form-input" placeholder="Confirm your password" required>
                                <button type="button" class="password-toggle" id="signupConfirmPasswordToggle">
                                    <i class="far fa-eye"></i>
                                </button>
                            </div>
                        </div>
                        <button class="btn btn-primary" id="signupButton">
                            <i class="fas fa-user-plus"></i> Sign Up
                        </button>
                        <div class="status-message" id="signupStatus"></div>
                        
                        <div style="text-align: center; margin-top: 20px;">
                            <p style="color: var(--text-secondary);">Already have an account? <a href="#" style="color: var(--primary); font-weight: 500; cursor: pointer;" id="showLoginLink">Sign in here!</a></p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Dashboard Container -->
        <div id="dashboardContainer" style="display: none;">
            <div class="header">
                <h1>
                    <i class="fas fa-clipboard-list"></i>
                    Notes Clips
                </h1>
            </div>

            <!-- Dashboard Header with Clock and Logo Center -->
            <div class="dashboard-header">
                <div class="dashboard-clock" id="pakistaniClock">
                    Loading...
                </div>
                
                <div class="dashboard-logo-center">
                    <h1>
                        <i class="fas fa-clipboard-list"></i>
                        Notes Clips
                    </h1>
                </div>
                
                <div class="reminder-notification grayed" id="reminderNotification">
                    <div class="notification-icon">
                        <i class="far fa-bell"></i>
                        <span class="notification-count" id="reminderCount" style="display: none;"></span>
                    </div>
                    <div class="notification-text" id="reminderText">No Reminders for Today!</div>
                    <div class="notification-arrow">
                        <i class="fas fa-chevron-down"></i>
                    </div>
                </div>
            </div>

            <div class="tabs">
                <div class="tab active" data-tab="dashboard">
                    <i class="fas fa-tachometer-alt"></i> Dashboard
                </div>
                <div class="tab" data-tab="passwords">
                    <i class="fas fa-key"></i> Passwords
                </div>
                <div class="tab" data-tab="notes">
                    <i class="fas fa-sticky-note"></i> Notes
                </div>
                <div class="tab" data-tab="workflow">
                    <i class="fas fa-tools"></i> Workflow
                </div>
                <div class="tab" data-tab="clipboard">
                    <i class="fas fa-clipboard"></i> Clipboard Sync
                </div>
                <div class="tab" data-tab="reminders">
                    <i class="fas fa-bell"></i> Reminders
                </div>
                <div class="tab" data-tab="history">
                    <i class="fas fa-history"></i> History
                </div>
                <div class="tab" data-tab="settings">
                    <i class="fas fa-cog"></i> Settings
                </div>
            </div>

            <div class="tool-container">
                <!-- Dashboard Tab -->
                <div id="dashboardTab" class="tab-content active">
                    <div class="tab-header">
                        <h2>Dashboard</h2>
                    </div>
                    <div class="cards-grid">
                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title">Quick Stats</h3>
                            </div>
                            <div class="card-field">
                                <div class="field-label">Total Passwords</div>
                                <div class="field-value">
                                    <span class="field-text" id="totalPasswords">0</span>
                                </div>
                            </div>
                            <div class="card-field">
                                <div class="field-label">Total Notes</div>
                                <div class="field-value">
                                    <span class="field-text" id="totalNotes">0</span>
                                </div>
                            </div>
                            <div class="card-field">
                                <div class="field-label">Today's Reminders</div>
                                <div class="field-value">
                                    <span class="field-text" id="todayReminders">0</span>
                                </div>
                            </div>
                        </div>
                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title">Recent Activity</h3>
                            </div>
                            <div id="recentActivity">
                                <!-- Recent activity will be populated here -->
                                <div class="empty-state" style="padding: 20px 0;">
                                    <i class="fas fa-history"></i>
                                    <p>No recent activity</p>
                                </div>
                            </div>
                        </div>
                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title">Open Dates</h3>
                            </div>
                            <div class="workflow-date-grid" id="openDatesContainer">
                                <!-- Open dates will be populated here -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Passwords Tab -->
                <div id="passwordsTab" class="tab-content">
                    <div class="tab-header">
                        <h2>Saved Passwords</h2>
                        <button class="add-btn" id="addPasswordBtn">
                            <i class="fas fa-plus"></i>
                        </button>
                    </div>
                    <div class="cards-grid" id="passwordsContainer">
                        <!-- Password cards will be dynamically added here -->
                    </div>
                </div>

                <!-- Notes Tab -->
                <div id="notesTab" class="tab-content">
                    <div class="tab-header">
                        <h2>Personal Notes</h2>
                        <button class="add-btn" id="addNoteBtn">
                            <i class="fas fa-plus"></i>
                        </button>
                    </div>
                    
                    <!-- Notes Sub-tabs -->
                    <div class="notes-sub-tabs">
                        <div class="note-sub-tab active" data-note-tab="notes">
                            <i class="fas fa-sticky-note"></i> Notes
                        </div>
                        <div class="note-sub-tab" data-note-tab="links">
                            <i class="fas fa-link"></i> Links
                        </div>
                        <div class="note-sub-tab" data-note-tab="scripts">
                            <i class="fas fa-code"></i> Scripts
                        </div>
                    </div>
                    
                    <!-- Notes Sub-content -->
                    <div id="notesSubContent" class="note-sub-content active">
                        <div class="cards-grid" id="notesContainer">
                            <!-- Note cards will be dynamically added here -->
                        </div>
                    </div>
                    
                    <!-- Links Sub-content -->
                    <div id="linksSubContent" class="note-sub-content">
                        <div class="cards-grid" id="linksContainer">
                            <!-- Link cards will be dynamically added here -->
                        </div>
                    </div>
                    
                    <!-- Scripts Sub-content -->
                    <div id="scriptsSubContent" class="note-sub-content">
                        <div class="cards-grid" id="scriptsContainer">
                            <!-- Script cards will be dynamically added here -->
                        </div>
                    </div>
                </div>

                <!-- Workflow Tab -->
                <div id="workflowTab" class="tab-content workflow-tab">
                    <div class="tab-header">
                        <h2>Workflow Tools</h2>
                    </div>
                    
                    <!-- Date Information Section -->
                    <div class="workflow-date-info">
                        <div class="workflow-date-header">
                            <h3>Open Dates Information</h3>
                            <button class="workflow-refresh-btn" onclick="updateWorkflowDateInfo()">
                                <i class="fas fa-sync-alt"></i>
                            </button>
                        </div>
                        <div class="workflow-date-grid" id="workflowDateInfo">
                            <!-- Date information will be populated here -->
                        </div>
                    </div>
                    
                    <!-- Workflow Tools Grid -->
                    <div class="workflow-tools-grid" id="workflowToolsGrid">
                        <!-- Workflow tools will be populated here -->
                    </div>
                    
                    <!-- Workflow Settings -->
                    <div class="workflow-settings" id="workflowSettingsBox">
                        <label class="workflow-settings-label">
                            <input type="checkbox" id="workflowOpenNewTab">
                            Open in New Tabs
                        </label>
                    </div>
                </div>

                <!-- Clipboard Sync Tab -->
                <div id="clipboardTab" class="tab-content">
                    <div class="tab-header">
                        <h2>Clipboard Sync</h2>
                    </div>
                    <div class="clipboard-container">
                        <div class="clipboard-actions">
                            <button class="btn btn-success" id="sendClipboardBtn">
                                <i class="fas fa-paper-plane"></i> Send Clipboard
                            </button>
                            <button class="btn btn-danger" id="receiveClipboardBtn">
                                <i class="fas fa-download"></i> Receive Clipboard
                            </button>
                        </div>
                        <div class="clipboard-preview">
                            <h3 class="clipboard-preview-title">Clipboard Content</h3>
                            <div class="clipboard-preview-content" id="clipboardPreview">
                                No content available. Send or receive clipboard data to see it here.
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Reminders Tab -->
                <div id="remindersTab" class="tab-content">
                    <div class="tab-header">
                        <h2>Reminders</h2>
                        <button class="add-btn" id="addReminderBtn">
                            <i class="fas fa-plus"></i>
                        </button>
                    </div>
                    <div class="reminders-container">
                        <div class="reminders-header" id="remindersHeader">
                            <i class="fas fa-info-circle"></i> There is no reminder for today!
                        </div>
                        <div class="reminders-tabs">
                            <div class="reminder-tab active" data-reminder-tab="today">Today</div>
                            <div class="reminder-tab" data-reminder-tab="upcoming">Upcoming</div>
                            <div class="reminder-tab" data-reminder-tab="all">All</div>
                        </div>
                        <div class="reminders-list" id="remindersList">
                            <!-- Reminders will be dynamically added here -->
                        </div>
                    </div>
                </div>

                <!-- History Tab -->
                <div id="historyTab" class="tab-content">
                    <div class="tab-header">
                        <h2>Activity History</h2>
                    </div>
                    <div class="history-list" id="historyContainer">
                        <!-- History items will be dynamically added here -->
                    </div>
                    <button class="load-more-btn" id="loadMoreHistory" style="display: none;">Load More</button>
                </div>

                <!-- Settings Tab -->
                <div id="settingsTab" class="tab-content">
                    <div class="tab-header">
                        <h2>Settings & Preferences</h2>
                    </div>
                    
                    <div class="user-greeting" id="userGreeting">
                        <i class="fas fa-user"></i>
                        <span>Hi, User! 🎉</span>
                    </div>
                    
                    <div class="settings-section">
                        <h3 class="settings-title">
                            <i class="fas fa-palette"></i>
                            <span>Appearance</span>
                        </h3>
                        <div class="settings-option">
                            <div class="option-label">
                                <span class="option-title">Theme</span>
                                <span class="option-desc">Choose your preferred theme</span>
                            </div>
                            <div>
                                <select id="themeSelect" class="form-input">
                                    <option value="light">Light Mode</option>
                                    <option value="dark">Dark Mode</option>
                                    <option value="gray">Gray Mode</option>
                                </select>
                            </div>
                        </div>
                        <div class="settings-option">
                            <div class="option-label">
                                <span class="option-title">Show Passwords</span>
                                <span class="option-desc">Display passwords in plain text on dashboard</span>
                            </div>
                            <label class="toggle-switch">
                                <input type="checkbox" id="showPasswordsToggle">
                                <span class="slider"></span>
                            </label>
                        </div>
                    </div>
                    
                    <div class="settings-section">
                        <h3 class="settings-title">
                            <i class="fas fa-user-cog"></i>
                            <span>Profile Settings</span>
                        </h3>
                        <div class="settings-option">
                            <div class="option-label">
                                <span class="option-title">Change Username</span>
                                <span class="option-desc">Update your display name</span>
                            </div>
                            <button class="btn btn-primary" id="changeUsernameBtn">Change</button>
                        </div>
                    </div>
                    
                    <div class="settings-section">
                        <h3 class="settings-title">
                            <i class="fas fa-lock"></i>
                            <span>Account Security</span>
                        </h3>
                        <div class="settings-option">
                            <div class="option-label">
                                <span class="option-title">Change Password</span>
                                <span class="option-desc">Update your portal password</span>
                            </div>
                            <button class="btn btn-primary" id="changePasswordBtn">Change</button>
                        </div>
                        <div class="settings-option">
                            <div class="option-label">
                                <span class="option-title">Quick Sign Out</span>
                                <span class="option-desc">Sign out from all other devices</span>
                            </div>
                            <button class="btn btn-danger" id="quickLogoutBtn">Sign Out All</button>
                        </div>
                        <div class="settings-option">
                            <div class="option-label">
                                <span class="option-title">Sign Out</span>
                                <span class="option-desc">Sign out from this device</span>
                            </div>
                            <button class="btn" id="logoutBtn">Sign Out</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <footer id="mainFooter">
        © Notes Clips 2025 - Secure Password & Notes Manager
    </footer>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-storage-compat.js"></script>
    
    <script>
        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyAHBBhvGJNyBQspqn2EP7BEPudyBR-j0iU",
            authDomain: "notes-clip.firebaseapp.com",
            projectId: "notes-clip",
            storageBucket: "notes-clip.firebasestorage.app",
            messagingSenderId: "788529103701",
            appId: "1:788529103701:web:ecb2f8b3a39fd97c87e5dc",
            measurementId: "G-C2F6NREENT"
        };
        
        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        const auth = firebase.auth();
        const storage = firebase.storage();
        
        // Google Auth Provider
        const provider = new firebase.auth.GoogleAuthProvider();
        
        // Application State
        let currentUser = null;
        let passwords = [];
        let notes = [];
        let links = [];
        let scripts = [];
        let reminders = [];
        let history = [];
        let editingItem = null;
        let selectedColor = 'default';
        let showPasswords = false;
        let profileImageUrl = null;
        let currentHistoryPage = 0;
        const HISTORY_PER_PAGE = 10;
        
        // Workflow Tools Data
        const workflowTools = [
            {
                name: "Excel Copier",
                description: "Copy and transform Excel data efficiently",
                url: "https://zongers.github.io/ec/",
                icon: "fas fa-copy"
            },
            {
                name: "Excel Copier++",
                description: "Enhanced Excel data copying with more features",
                url: "https://zongers.github.io/ecn/",
                icon: "fas fa-copy"
            },
            {
                name: "Data Unit Convertor",
                description: "Convert between different data units",
                url: "https://zongers.github.io/duc/",
                icon: "fas fa-exchange-alt"
            },
            {
                name: "Open Date Calculator",
                description: "Calculate dates and time intervals",
                url: "https://zongers.github.io/odrc/",
                icon: "fas fa-calculator"
            },
            {
                name: "All Open Date Calculator",
                description: "Calculate all open dates",
                url: "https://zongers.github.io/aoc/",
                icon: "fas fa-calculator"
            },
            {
                name: "Transferred Follow-up ID",
                description: "Identify transferred follow-ups",
                url: "https://zongers.github.io/tfi/",
                icon: "fas fa-fingerprint"
            },
            {
                name: "Package Date Calculator",
                description: "Calculate package dates",
                url: "https://zongers.github.io/pdc/",
                icon: "fas fa-box-open"
            },
            {
                name: "Duplicate Remover",
                description: "Remove duplicate follow-ups",
                url: "https://zongers.github.io/dfr/",
                icon: "fas fa-backspace"
            },
            {
                name: "Excel Date Formatter",
                description: "Format dates in Excel files",
                url: "https://zongers.github.io/edf/",
                icon: "fas fa-table"
            },
            {
                name: "Temp Box",
                description: "Temporary data storage",
                url: "https://zongers.github.io/tib/",
                icon: "fas fa-archive"
            },
            {
                name: "Number Divider",
                description: "Divide numbers with ease",
                url: "https://zongers.github.io/nd/",
                icon: "fas fa-grip-lines"
            },
            {
                name: "Expiry to Excel",
                description: "Add expiry dates to Excel data",
                url: "https://zongers.github.io/ete/",
                icon: "fas fa-file-excel"
            },
            {
                name: "CC Data Verification",
                description: "Identify missing data in CC records",
                url: "https://zongers.github.io/ccv/",
                icon: "fas fa-check-circle"
            },
            {
                name: "Minus Price (-)",
                description: "Calculate price differences and deductions",
                url: "https://zongers.github.io/mp/",
                icon: "fas fa-minus-circle"
            }
        ];
        
        // Initialize the application
        document.addEventListener('DOMContentLoaded', initApp);
        
        function initApp() {
            // Show loading animation initially
            document.getElementById('loadingOverlay').style.display = 'flex';
            
            // Set up event listeners
            setupEventListeners();
            
            // Check authentication state
            auth.onAuthStateChanged(user => {
                if (user) {
                    currentUser = user;
                    showDashboard();
                    loadUserData();
                } else {
                    showAuth();
                }
                // Hide loading after auth state is determined
                setTimeout(() => {
                    document.getElementById('loadingOverlay').style.display = 'none';
                    document.getElementById('loginCard').classList.add('active');
                }, 500);
            });
        }
        
        function setupEventListeners() {
            // Login/Signup form toggles with transitions
            document.getElementById('showSignupLink').addEventListener('click', showSignupForm);
            document.getElementById('showLoginLink').addEventListener('click', showLoginForm);
            
            // Login/Signup buttons
            document.getElementById('loginButton').addEventListener('click', handleLogin);
            document.getElementById('signupButton').addEventListener('click', handleSignup);
            
            // Password toggles
            document.querySelectorAll('.password-toggle').forEach(toggle => {
                toggle.addEventListener('click', function() {
                    const input = this.previousElementSibling;
                    const icon = this.querySelector('i');
                    
                    if (input.type === 'password') {
                        input.type = 'text';
                        icon.classList.remove('fa-eye');
                        icon.classList.add('fa-eye-slash');
                    } else {
                        input.type = 'password';
                        icon.classList.remove('fa-eye-slash');
                        icon.classList.add('fa-eye');
                    }
                });
            });
            
            // Modal close buttons
            document.getElementById('closePasswordModal').addEventListener('click', () => closeModal('passwordModal'));
            document.getElementById('cancelPasswordBtn').addEventListener('click', () => closeModal('passwordModal'));
            document.getElementById('closeNoteModal').addEventListener('click', () => closeModal('noteModal'));
            document.getElementById('cancelNoteBtn').addEventListener('click', () => closeModal('noteModal'));
            document.getElementById('closeChangePasswordModal').addEventListener('click', () => closeModal('changePasswordModal'));
            document.getElementById('cancelChangePasswordBtn').addEventListener('click', () => closeModal('changePasswordModal'));
            document.getElementById('cancelConfirmationBtn').addEventListener('click', () => closeModal('confirmationModal'));
            document.getElementById('closeNotePopup').addEventListener('click', () => closeModal('notePopup'));
            document.getElementById('closeReminderModal').addEventListener('click', () => closeModal('reminderModal'));
            document.getElementById('cancelReminderBtn').addEventListener('click', () => closeModal('reminderModal'));
            
            // Save buttons
            document.getElementById('savePasswordBtn').addEventListener('click', savePassword);
            document.getElementById('saveNoteBtn').addEventListener('click', saveNote);
            document.getElementById('saveChangePasswordBtn').addEventListener('click', changePassword);
            document.getElementById('saveReminderBtn').addEventListener('click', saveReminder);
            
            // Second password button
            document.getElementById('addSecondPasswordBtn').addEventListener('click', toggleSecondPassword);
            
            // Color options
            document.querySelectorAll('.color-option').forEach(option => {
                option.addEventListener('click', () => {
                    document.querySelectorAll('.color-option').forEach(opt => opt.classList.remove('selected'));
                    option.classList.add('selected');
                    selectedColor = option.dataset.color;
                });
            });
            
            // Settings toggles
            document.getElementById('themeSelect').addEventListener('change', changeTheme);
            document.getElementById('showPasswordsToggle').addEventListener('change', togglePasswordVisibility);
            
            // Dashboard buttons
            document.getElementById('addPasswordBtn').addEventListener('click', () => openPasswordModal());
            document.getElementById('addNoteBtn').addEventListener('click', () => openNoteModal());
            document.getElementById('addReminderBtn').addEventListener('click', () => openReminderModal());
            document.getElementById('changePasswordBtn').addEventListener('click', () => openChangePasswordModal());
            document.getElementById('changeUsernameBtn').addEventListener('click', () => openChangeUsernameModal());
            document.getElementById('quickLogoutBtn').addEventListener('click', () => openQuickLogoutModal());
            document.getElementById('logoutBtn').addEventListener('click', showLogoutModal);
            
            // Clipboard buttons
            document.getElementById('sendClipboardBtn').addEventListener('click', sendClipboard);
            document.getElementById('receiveClipboardBtn').addEventListener('click', receiveClipboard);
            
            // History load more
            document.getElementById('loadMoreHistory').addEventListener('click', loadMoreHistory);
            
            // Reminder tabs
            document.querySelectorAll('.reminder-tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    document.querySelectorAll('.reminder-tab').forEach(t => t.classList.remove('active'));
                    this.classList.add('active');
                    filterReminders(this.dataset.reminderTab);
                });
            });
            
            // Tab switching
            document.querySelectorAll('.tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                    this.classList.add('active');
                    switchTab(this.dataset.tab);
                    
                    // Save the active tab to localStorage
                    localStorage.setItem('lastActiveTab', this.dataset.tab);
                });
            });
            
            // Notes sub-tabs
            document.querySelectorAll('.note-sub-tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    document.querySelectorAll('.note-sub-tab').forEach(t => t.classList.remove('active'));
                    this.classList.add('active');
                    switchNoteTab(this.dataset.noteTab);
                });
            });
            
            // Reminder notification toggle
            document.getElementById('reminderNotification').addEventListener('click', toggleReminderList);
            
            // Workflow settings
            document.getElementById('workflowSettingsBox').addEventListener('click', (event) => {
                if (event.target === document.getElementById('workflowOpenNewTab') || event.target.closest('.workflow-settings-label')) {
                    return;
                }
                const checkbox = document.getElementById('workflowOpenNewTab');
                checkbox.checked = !checkbox.checked;
                checkbox.dispatchEvent(new Event('change'));
            });
            
            document.getElementById('workflowOpenNewTab').addEventListener('change', function() {
                localStorage.setItem('workflowOpenInNewTab', this.checked);
            });
        }
        
        // Authentication Functions
        function showAuth() {
            document.getElementById('loginContainer').style.display = 'block';
            document.getElementById('dashboardContainer').style.display = 'none';
            document.getElementById('mainFooter').style.display = 'none';
        }
        
        function showDashboard() {
            document.getElementById('loginContainer').style.display = 'none';
            document.getElementById('dashboardContainer').style.display = 'block';
            document.getElementById('mainFooter').style.display = 'block';
            
            // Update user greeting
            if (currentUser) {
                const displayName = currentUser.displayName || currentUser.email || 'User';
                document.getElementById('userGreeting').innerHTML = `<i class="fas fa-user"></i><span>Hi, ${displayName}! 🎉</span>`;
            }
            
            // Start the clock
            updatePakistaniClock();
            setInterval(updatePakistaniClock, 1000);
            
            // Initialize workflow tab
            initializeWorkflowTab();
            
            // Load the last active tab
            const lastActiveTab = localStorage.getItem('lastActiveTab') || 'dashboard';
            switchTab(lastActiveTab);
            
            // Update the tab UI to show the active tab
            document.querySelectorAll('.tab').forEach(tab => {
                if (tab.dataset.tab === lastActiveTab) {
                    tab.classList.add('active');
                } else {
                    tab.classList.remove('active');
                }
            });
        }
        
        function showLoginForm() {
            const loginForm = document.getElementById('loginForm');
            const signupForm = document.getElementById('signupForm');
            
            signupForm.classList.remove('visible');
            signupForm.classList.add('hidden');
            
            setTimeout(() => {
                loginForm.classList.remove('hidden');
                loginForm.classList.add('visible');
            }, 300);
            
            clearStatusMessages();
        }
        
        function showSignupForm() {
            const loginForm = document.getElementById('loginForm');
            const signupForm = document.getElementById('signupForm');
            
            loginForm.classList.remove('visible');
            loginForm.classList.add('hidden');
            
            setTimeout(() => {
                signupForm.classList.remove('hidden');
                signupForm.classList.add('visible');
            }, 300);
            
            clearStatusMessages();
        }
        
        function clearStatusMessages() {
            document.getElementById('loginStatus').style.display = 'none';
            document.getElementById('signupStatus').style.display = 'none';
        }
        
        function showStatus(elementId, message, isSuccess) {
            const statusElement = document.getElementById(elementId);
            statusElement.textContent = message;
            statusElement.className = isSuccess ? 'status-message status-success' : 'status-message status-error';
            statusElement.style.display = 'block';
        }
        
        async function handleLogin() {
            const identifier = document.getElementById('login-identifier').value;
            const password = document.getElementById('login-password').value;
            const loginBtn = document.getElementById('loginButton');
            
            if (!identifier || !password) {
                showStatus('loginStatus', 'Please fill in all fields', false);
                return;
            }
            
            // Show loading state
            const originalText = loginBtn.innerHTML;
            loginBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Signing in...';
            loginBtn.disabled = true;
            
            try {
                // Try to sign in with email/password
                let email = identifier;
                
                // If identifier doesn't contain @, assume it's a username and append @notesclips.com
                if (!identifier.includes('@')) {
                    email = `${identifier}@notesclips.com`;
                }
                
                await auth.signInWithEmailAndPassword(email, password);
                
                // Show success animation
                loginBtn.innerHTML = '<i class="fas fa-check"></i> Sign in Successful!';
                loginBtn.classList.add('button-success');
                
                // Wait for animation to complete before redirecting
                setTimeout(() => {
                    // Success - user will be redirected via onAuthStateChanged
                }, 1500);
            } catch (error) {
                showStatus('loginStatus', 'Invalid sign in credentials. Please try again.', false);
                loginBtn.innerHTML = originalText;
                loginBtn.disabled = false;
            }
        }
        
        async function handleSignup() {
            const username = document.getElementById('signup-username').value;
            const email = document.getElementById('signup-email').value;
            const password = document.getElementById('signup-password').value;
            const confirmPassword = document.getElementById('signup-confirm-password').value;
            const signupBtn = document.getElementById('signupButton');
            
            if (!username || !password || !confirmPassword) {
                showStatus('signupStatus', 'Please fill in all required fields', false);
                return;
            }
            
            // Validate passwords match
            if (password !== confirmPassword) {
                showStatus('signupStatus', 'Passwords do not match.', false);
                return;
            }
            
            // Show loading state
            const originalText = signupBtn.innerHTML;
            signupBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Creating account...';
            signupBtn.disabled = true;
            
            try {
                // Create user with email and password
                const userEmail = email || `${username}@notesclips.com`;
                const userCredential = await auth.createUserWithEmailAndPassword(userEmail, password);
                
                // Update user profile with username
                await userCredential.user.updateProfile({
                    displayName: username
                });
                
                // Create user document in Firestore
                await db.collection('users').doc(userCredential.user.uid).set({
                    username: username,
                    email: email || '',
                    createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                    lastLogin: firebase.firestore.FieldValue.serverTimestamp()
                });
                
                // Show success message
                signupBtn.innerHTML = '<i class="fas fa-check"></i> Account Created!';
                signupBtn.classList.add('button-success');
                
                // Success - user will be redirected via onAuthStateChanged
            } catch (error) {
                showStatus('signupStatus', error.message, false);
                signupBtn.innerHTML = originalText;
                signupBtn.disabled = false;
            }
        }
        
        function showLogoutModal() {
            document.getElementById('logoutModal').classList.add('active');
        }
        
        function hideLogoutModal() {
            document.getElementById('logoutModal').classList.remove('active');
        }
        
        function handleModalClick(event) {
            if (event.target.classList.contains('modal-overlay') || event.target.classList.contains('note-popup')) {
                event.target.classList.remove('active');
            }
        }
        
        function confirmLogout() {
            // Hide the modal first
            hideLogoutModal();
            
            // Show sign out animation
            document.getElementById('loadingOverlay').style.display = 'flex';
            
            setTimeout(() => {
                auth.signOut().then(() => {
                    document.getElementById('loadingOverlay').style.display = 'none';
                    showAuth();
                });
            }, 1000);
        }
        
        // Navigation Functions
        function switchTab(tabName) {
            // Show selected tab content
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            document.getElementById(`${tabName}Tab`).classList.add('active');
            
            // Update dashboard stats when switching to dashboard
            if (tabName === 'dashboard') {
                updateDashboardStats();
            }
            
            // Initialize workflow tab when switching to it
            if (tabName === 'workflow') {
                initializeWorkflowTab();
            }
            
            // Load history when switching to history tab
            if (tabName === 'history') {
                loadHistory();
            }
        }
        
        function switchNoteTab(tabName) {
            // Show selected note sub-tab content
            document.querySelectorAll('.note-sub-content').forEach(content => {
                content.classList.remove('active');
            });
            document.getElementById(`${tabName}SubContent`).classList.add('active');
            
            // Load data for the selected tab
            if (tabName === 'notes') {
                loadNotes();
            } else if (tabName === 'links') {
                loadLinks();
            } else if (tabName === 'scripts') {
                loadScripts();
            }
        }
        
        // Dashboard Functions
 function updatePakistaniClock() {
    const now = new Date();
    const options = { 
        timeZone: 'Asia/Karachi'
    };
    
    const localTime = new Date(now.toLocaleString('en-US', options));
    
    // Custom format to ensure consistent length
    let hours = localTime.getHours();
    const minutes = localTime.getMinutes().toString().padStart(2, '0');
    const ampm = hours >= 12 ? 'PM' : 'AM';
    
    hours = hours % 12;
    hours = hours ? hours : 12; // the hour '0' should be '12'
    
    const timeString = `${hours}:${minutes} ${ampm}`;
    const dateString = localTime.toLocaleDateString('en-US', {
        day: '2-digit',
        month: 'short',
        year: 'numeric'
    });
    
    document.getElementById('pakistaniClock').textContent = `${timeString} | ${dateString}`;
}
        
        function updateDashboardStats() {
            document.getElementById('totalPasswords').textContent = passwords.length;
            document.getElementById('totalNotes').textContent = notes.length;
            
            // Count today's reminders
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            const todayReminders = reminders.filter(reminder => {
                const reminderDate = reminder.date.toDate();
                reminderDate.setHours(0, 0, 0, 0);
                return reminderDate.getTime() === today.getTime();
            });
            
            document.getElementById('todayReminders').textContent = todayReminders.length;
            
            // Update reminder notification
            updateReminderNotification(todayReminders);
            
            // Update recent activity - show only last 3 activities
            updateRecentActivity();
            
            // Update open dates
            updateOpenDates();
        }
        
        function updateOpenDates() {
            const today = new Date();
            today.setHours(0, 0, 0, 0); // Normalize to start of day
            
            // Calculate dates
            const rolloverDate = new Date(today);
            rolloverDate.setDate(today.getDate() - 29);
            
            const mbbDate = new Date(today);
            mbbDate.setDate(today.getDate() - 31);
            
            const prepaidDate = new Date(today);
            prepaidDate.setDate(today.getDate() - 20);
            
            // Format dates
            const formatDate = (date) => {
                const options = { day: 'numeric', month: 'short', year: 'numeric' };
                return date.toLocaleDateString('en-PK', options).replace(/(\d+)\s(\w+)\s(\d+)/, '$1/$2/$3');
            };
            
            // Update UI
            const container = document.getElementById('openDatesContainer');
            container.innerHTML = `
                <div class="workflow-date-item rollover">
                    <span class="workflow-date-label">Rollover Date</span>
                    <span class="workflow-date-value">${formatDate(rolloverDate)}</span>
                </div>
                <div class="workflow-date-item mbb">
                    <span class="workflow-date-label">MBB Open</span>
                    <span class="workflow-date-value">${formatDate(mbbDate)}</span>
                </div>
                <div class="workflow-date-item prepaid">
                    <span class="workflow-date-label">20 Days Prepaid Open</span>
                    <span class="workflow-date-value">${formatDate(prepaidDate)}</span>
                </div>
            `;
        }
        
        function updateReminderNotification(todayReminders) {
            const notification = document.getElementById('reminderNotification');
            const countElement = document.getElementById('reminderCount');
            const textElement = document.getElementById('reminderText');
            
            if (todayReminders.length > 0) {
                notification.classList.remove('grayed');
                notification.classList.add('active');
                countElement.textContent = todayReminders.length;
                countElement.style.display = 'flex';
                textElement.textContent = todayReminders.length === 1 ? 
                    'You have a Reminder Today!' : 
                    `You have ${todayReminders.length} Reminders Today!`;
                
                // Update reminder list
                updateReminderList(todayReminders);
            } else {
                notification.classList.remove('active');
                notification.classList.add('grayed');
                countElement.style.display = 'none';
                textElement.textContent = 'No Reminders for Today!';
            }
        }
        
        function updateReminderList(todayReminders) {
            const reminderList = document.querySelector('.reminder-list');
            if (!reminderList) return;
            
            reminderList.innerHTML = '';
            
            todayReminders.forEach(reminder => {
                const reminderItem = document.createElement('div');
                reminderItem.className = 'reminder-item';
                
                const reminderTime = reminder.date.toDate().toLocaleTimeString('en-US', {
                    hour: '2-digit',
                    minute: '2-digit'
                });
                
                reminderItem.innerHTML = `
                    <div class="reminder-title">${reminder.title}</div>
                    <div class="reminder-time">${reminderTime}</div>
                `;
                
                reminderList.appendChild(reminderItem);
            });
        }
        
        function toggleReminderList() {
            const notification = document.getElementById('reminderNotification');
            notification.classList.toggle('expanded');
        }
        
        function updateRecentActivity() {
            const recentActivity = document.getElementById('recentActivity');
            
            if (history.length === 0) {
                recentActivity.innerHTML = `
                    <div class="empty-state" style="padding: 20px 0;">
                        <i class="fas fa-history"></i>
                        <p>No recent activity</p>
                    </div>
                `;
                return;
            }
            
            // Show only the 3 most recent activities
            const recentItems = history.slice(0, 3);
            
            let activityHTML = '';
            recentItems.forEach(item => {
                const time = item.timestamp ? 
                    new Date(item.timestamp.toDate()).toLocaleTimeString('en-US', {
                        hour: '2-digit',
                        minute: '2-digit'
                    }) : 
                    'Unknown time';
                
                activityHTML += `
                    <div class="history-item" style="margin-bottom: 10px; padding: 10px;">
                        <div class="history-header">
                            <span class="history-action">${item.action}</span>
                            <span class="history-time">${time}</span>
                        </div>
                        <div class="history-details">${item.details}</div>
                    </div>
                `;
            });
            
            recentActivity.innerHTML = activityHTML;
        }
        
        // Theme Functions
        function changeTheme() {
            const theme = document.getElementById('themeSelect').value;
            document.body.classList.remove('dark-theme', 'gray-theme');
            
            if (theme === 'dark') {
                document.body.classList.add('dark-theme');
            } else if (theme === 'gray') {
                document.body.classList.add('gray-theme');
            }
            
            // Save preference to Firestore
            if (currentUser) {
                db.collection('userPreferences').doc(currentUser.uid).set({
                    theme: theme
                }, { merge: true });
            }
        }
        
        function togglePasswordVisibility() {
            showPasswords = document.getElementById('showPasswordsToggle').checked;
            renderPasswords();
            
            // Save preference to Firestore
            if (currentUser) {
                db.collection('userPreferences').doc(currentUser.uid).set({
                    showPasswords: showPasswords
                }, { merge: true });
            }
        }
        
        // Modal Functions
        function openModal(modalId) {
            document.getElementById(modalId).classList.add('active');
        }
        
        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
            resetForm(modalId);
            editingItem = null;
        }
        
        function resetForm(modalId) {
            const modal = document.getElementById(modalId);
            if (!modal) return;
            
            const inputs = modal.querySelectorAll('input, textarea');
            inputs.forEach(input => {
                input.value = '';
            });
            
            // Reset color selection
            if (modalId === 'noteModal') {
                document.querySelectorAll('.color-option').forEach(opt => opt.classList.remove('selected'));
                document.querySelector('.color-option.color-default').classList.add('selected');
                selectedColor = 'default';
            }
            
            // Reset second password field
            if (modalId === 'passwordModal') {
                document.getElementById('secondPasswordGroup').style.display = 'none';
            }
            
            // Set default date for reminder modal
            if (modalId === 'reminderModal') {
                const today = new Date();
                const formattedDate = today.toISOString().split('T')[0];
                document.getElementById('reminder-date').value = formattedDate;
            }
        }
        
        // Password Manager Functions
        function openPasswordModal(item = null) {
            editingItem = item;
            
            if (item) {
                document.getElementById('passwordModalTitle').textContent = 'Edit Password';
                document.getElementById('platform-name').value = item.platformName;
                document.getElementById('platform-username').value = item.username || '';
                document.getElementById('platform-password').value = item.password1;
                
                if (item.password2) {
                    document.getElementById('platform-password2').value = item.password2;
                    document.getElementById('secondPasswordGroup').style.display = 'block';
                }
            } else {
                document.getElementById('passwordModalTitle').textContent = 'Add Password';
            }
            
            openModal('passwordModal');
        }
        
        function toggleSecondPassword() {
            const secondPasswordGroup = document.getElementById('secondPasswordGroup');
            if (secondPasswordGroup.style.display === 'none') {
                secondPasswordGroup.style.display = 'block';
            } else {
                secondPasswordGroup.style.display = 'none';
                document.getElementById('platform-password2').value = '';
            }
        }
        
        async function savePassword() {
            const platformName = document.getElementById('platform-name').value;
            const username = document.getElementById('platform-username').value;
            const password1 = document.getElementById('platform-password').value;
            const password2 = document.getElementById('platform-password2').value;
            
            if (!platformName || !password1) {
                alert('Please fill in all required fields.');
                return;
            }
            
            try {
                if (editingItem) {
                    // Update existing password
                    await db.collection('passwords').doc(editingItem.id).update({
                        platformName: platformName,
                        username: username,
                        password1: password1,
                        password2: password2 || '',
                        updatedAt: firebase.firestore.FieldValue.serverTimestamp()
                    });
                    
                    // Log the action with actual data
                    await logHistory('Updated password', `Updated password for ${platformName}`, {
                        platformName: platformName,
                        username: username,
                        oldPassword: editingItem.password1,
                        newPassword: password1,
                        oldPassword2: editingItem.password2,
                        newPassword2: password2
                    });
                } else {
                    // Add new password
                    await db.collection('passwords').add({
                        userId: currentUser.uid,
                        platformName: platformName,
                        username: username,
                        password1: password1,
                        password2: password2 || '',
                        createdAt: firebase.firestore.FieldValue.serverTimestamp()
                    });
                    
                    // Log the action
                    await logHistory('Added password', `Added password for ${platformName}`, {
                        platformName: platformName,
                        username: username,
                        password1: password1,
                        password2: password2
                    });
                }
                
                closeModal('passwordModal');
                loadPasswords();
            } catch (error) {
                console.error('Error saving password:', error);
                alert('Error saving password. Please try again.');
            }
        }
        
        async function deletePassword(id, platformName) {
            openConfirmationModal('Are you sure you want to delete this password?', async () => {
                try {
                    await db.collection('passwords').doc(id).delete();
                    
                    // Log the action
                    await logHistory('Deleted password', `Deleted password for ${platformName}`);
                    
                    loadPasswords();
                } catch (error) {
                    console.error('Error deleting password:', error);
                    alert('Error deleting password. Please try again.');
                }
            });
        }
        
        // Notes Manager Functions
        function openNoteModal(item = null) {
            editingItem = item;
            
            if (item) {
                document.getElementById('noteModalTitle').textContent = 'Edit Note';
                document.getElementById('note-title').value = item.title;
                document.getElementById('note-content').value = item.content;
                
                // Set color
                document.querySelectorAll('.color-option').forEach(opt => opt.classList.remove('selected'));
                document.querySelector(`.color-option.color-${item.color}`).classList.add('selected');
                selectedColor = item.color;
            } else {
                document.getElementById('noteModalTitle').textContent = 'Add Note';
            }
            
            openModal('noteModal');
        }
        
        async function saveNote() {
            const title = document.getElementById('note-title').value;
            const content = document.getElementById('note-content').value;
            
            if (!title || !content) {
                alert('Please fill in all required fields.');
                return;
            }
            
            try {
                if (editingItem) {
                    // Update existing note
                    await db.collection('notes').doc(editingItem.id).update({
                        title: title,
                        content: content,
                        color: selectedColor,
                        updatedAt: firebase.firestore.FieldValue.serverTimestamp()
                    });
                    
                    // Log the action with actual data
                    await logHistory('Updated note', `Updated note: ${title}`, {
                        title: title,
                        oldContent: editingItem.content,
                        newContent: content,
                        color: selectedColor
                    });
                } else {
                    // Add new note
                    await db.collection('notes').add({
                        userId: currentUser.uid,
                        title: title,
                        content: content,
                        color: selectedColor,
                        createdAt: firebase.firestore.FieldValue.serverTimestamp()
                    });
                    
                    // Log the action
                    await logHistory('Added note', `Added note: ${title}`, {
                        title: title,
                        content: content,
                        color: selectedColor
                    });
                }
                
                closeModal('noteModal');
                loadNotes();
            } catch (error) {
                console.error('Error saving note:', error);
                alert('Error saving note. Please try again.');
            }
        }
        
        async function deleteNote(id, title) {
            openConfirmationModal('Are you sure you want to delete this note?', async () => {
                try {
                    await db.collection('notes').doc(id).delete();
                    
                    // Log the action
                    await logHistory('Deleted note', `Deleted note: ${title}`);
                    
                    loadNotes();
                } catch (error) {
                    console.error('Error deleting note:', error);
                    alert('Error deleting note. Please try again.');
                }
            });
        }
        
        // Links Manager Functions
        async function loadLinks() {
            try {
                const snapshot = await db.collection('links')
                    .where('userId', '==', currentUser.uid)
                    .orderBy('createdAt', 'desc')
                    .get();
                
                links = [];
                snapshot.forEach(doc => {
                    links.push({
                        id: doc.id,
                        ...doc.data()
                    });
                });
                
                renderLinks();
            } catch (error) {
                console.error('Error loading links:', error);
            }
        }
        
        function renderLinks() {
            const container = document.getElementById('linksContainer');
            container.innerHTML = '';
            
            if (links.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-link"></i>
                        <h3>No Links Saved</h3>
                        <p>Click the + button to add your first link</p>
                    </div>
                `;
                return;
            }
            
            links.forEach(link => {
                const linkCard = document.createElement('div');
                linkCard.className = 'card';
                
                linkCard.innerHTML = `
                    <div class="card-header">
                        <h3 class="card-title">${link.name}</h3>
                        <div class="card-actions">
                            <button class="action-btn edit-link" data-id="${link.id}">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="action-btn delete-link" data-id="${link.id}" data-name="${link.name}">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                    <div class="card-field">
                        <div class="field-label">Website Name</div>
                        <div class="field-value" data-value="${link.name}">
                            <span class="field-text">${link.name}</span>
                            <button class="copy-btn" data-value="${link.name}">
                                <i class="far fa-copy"></i>
                            </button>
                        </div>
                    </div>
                    <div class="card-field">
                        <div class="field-label">URL</div>
                        <div class="field-value" data-value="${link.url}">
                            <span class="field-text">${link.url}</span>
                            <button class="copy-btn" data-value="${link.url}">
                                <i class="far fa-copy"></i>
                            </button>
                        </div>
                    </div>
                `;
                
                container.appendChild(linkCard);
            });
            
            // Add event listeners for the new elements
            document.querySelectorAll('.edit-link').forEach(btn => {
                btn.addEventListener('click', () => {
                    const linkId = btn.dataset.id;
                    const link = links.find(l => l.id === linkId);
                    openLinkModal(link);
                });
            });
            
            document.querySelectorAll('.delete-link').forEach(btn => {
                btn.addEventListener('click', () => {
                    const linkId = btn.dataset.id;
                    const linkName = btn.dataset.name;
                    deleteLink(linkId, linkName);
                });
            });
            
            document.querySelectorAll('.copy-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const value = this.dataset.value;
                    copyToClipboard(value);
                    
                    // Show feedback
                    const originalIcon = this.innerHTML;
                    this.innerHTML = '<i class="fas fa-check"></i>';
                    setTimeout(() => {
                        this.innerHTML = originalIcon;
                    }, 2000);
                });
            });
            
            // Add click event to field values for copying
            document.querySelectorAll('.field-value').forEach(field => {
                field.addEventListener('click', function() {
                    const value = this.dataset.value;
                    if (value) {
                        copyToClipboard(value);
                        
                        // Show feedback
                        const copyBtn = this.querySelector('.copy-btn');
                        if (copyBtn) {
                            const originalIcon = copyBtn.innerHTML;
                            copyBtn.innerHTML = '<i class="fas fa-check"></i>';
                            setTimeout(() => {
                                copyBtn.innerHTML = originalIcon;
                            }, 2000);
                        }
                    }
                });
            });
        }
        
        // Scripts Manager Functions
        async function loadScripts() {
            try {
                const snapshot = await db.collection('scripts')
                    .where('userId', '==', currentUser.uid)
                    .orderBy('createdAt', 'desc')
                    .get();
                
                scripts = [];
                snapshot.forEach(doc => {
                    scripts.push({
                        id: doc.id,
                        ...doc.data()
                    });
                });
                
                renderScripts();
            } catch (error) {
                console.error('Error loading scripts:', error);
            }
        }
        
        function renderScripts() {
            const container = document.getElementById('scriptsContainer');
            container.innerHTML = '';
            
            if (scripts.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-code"></i>
                        <h3>No Scripts Saved</h3>
                        <p>Click the + button to add your first script</p>
                    </div>
                `;
                return;
            }
            
            scripts.forEach(script => {
                const scriptCard = document.createElement('div');
                scriptCard.className = 'card';
                
                // Truncate content if too long
                const content = script.content.length > 150 ? 
                    script.content.substring(0, 150) + '...' : 
                    script.content;
                
                scriptCard.innerHTML = `
                    <div class="card-header">
                        <h3 class="card-title">${script.name}</h3>
                        <div class="card-actions">
                            <button class="action-btn edit-script" data-id="${script.id}">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="action-btn delete-script" data-id="${script.id}" data-name="${script.name}">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                    <div class="card-field">
                        <div class="field-label">Script Name</div>
                        <div class="field-value" data-value="${script.name}">
                            <span class="field-text">${script.name}</span>
                            <button class="copy-btn" data-value="${script.name}">
                                <i class="far fa-copy"></i>
                            </button>
                        </div>
                    </div>
                    <div class="card-field">
                        <div class="field-label">Script Content</div>
                        <div class="field-value" data-value="${script.content}">
                            <span class="field-text">${content}</span>
                            <button class="copy-btn" data-value="${script.content}">
                                <i class="far fa-copy"></i>
                            </button>
                        </div>
                    </div>
                `;
                
                container.appendChild(scriptCard);
            });
            
            // Add event listeners for the new elements
            document.querySelectorAll('.edit-script').forEach(btn => {
                btn.addEventListener('click', () => {
                    const scriptId = btn.dataset.id;
                    const script = scripts.find(s => s.id === scriptId);
                    openScriptModal(script);
                });
            });
            
            document.querySelectorAll('.delete-script').forEach(btn => {
                btn.addEventListener('click', () => {
                    const scriptId = btn.dataset.id;
                    const scriptName = btn.dataset.name;
                    deleteScript(scriptId, scriptName);
                });
            });
            
            document.querySelectorAll('.copy-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const value = this.dataset.value;
                    copyToClipboard(value);
                    
                    // Show feedback
                    const originalIcon = this.innerHTML;
                    this.innerHTML = '<i class="fas fa-check"></i>';
                    setTimeout(() => {
                        this.innerHTML = originalIcon;
                    }, 2000);
                });
            });
            
            // Add click event to field values for copying
            document.querySelectorAll('.field-value').forEach(field => {
                field.addEventListener('click', function() {
                    const value = this.dataset.value;
                    if (value) {
                        copyToClipboard(value);
                        
                        // Show feedback
                        const copyBtn = this.querySelector('.copy-btn');
                        if (copyBtn) {
                            const originalIcon = copyBtn.innerHTML;
                            copyBtn.innerHTML = '<i class="fas fa-check"></i>';
                            setTimeout(() => {
                                copyBtn.innerHTML = originalIcon;
                            }, 2000);
                        }
                    }
                });
            });
        }
        
        // Note Popup Functions
        function openNotePopup(note) {
            document.getElementById('notePopupTitle').textContent = note.title;
            document.getElementById('notePopupContent').textContent = note.content;
            document.getElementById('notePopup').classList.add('active');
        }
        
        // Reminder Functions
        function openReminderModal(item = null) {
            editingItem = item;
            
            if (item) {
                document.getElementById('reminderModalTitle').textContent = 'Edit Reminder';
                document.getElementById('reminder-title').value = item.title;
                document.getElementById('reminder-description').value = item.description || '';
                
                // Format date for input
                const date = item.date.toDate();
                const formattedDate = date.toISOString().split('T')[0];
                document.getElementById('reminder-date').value = formattedDate;
            } else {
                document.getElementById('reminderModalTitle').textContent = 'Add Reminder';
                
                // Set default date to today
                const today = new Date();
                const formattedDate = today.toISOString().split('T')[0];
                document.getElementById('reminder-date').value = formattedDate;
            }
            
            openModal('reminderModal');
        }
        
        async function saveReminder() {
            const title = document.getElementById('reminder-title').value;
            const description = document.getElementById('reminder-description').value;
            const dateStr = document.getElementById('reminder-date').value;
            
            if (!title || !dateStr) {
                alert('Please fill in all required fields.');
                return;
            }
            
            const date = new Date(dateStr);
            if (isNaN(date.getTime())) {
                alert('Invalid date format.');
                return;
            }
            
            try {
                if (editingItem) {
                    // Update existing reminder
                    await db.collection('reminders').doc(editingItem.id).update({
                        title: title,
                        description: description,
                        date: firebase.firestore.Timestamp.fromDate(date),
                        updatedAt: firebase.firestore.FieldValue.serverTimestamp()
                    });
                    
                    // Log the action
                    await logHistory('Updated reminder', `Updated reminder: ${title}`, {
                        title: title,
                        description: description,
                        date: dateStr
                    });
                } else {
                    // Add new reminder
                    await db.collection('reminders').add({
                        userId: currentUser.uid,
                        title: title,
                        description: description,
                        date: firebase.firestore.Timestamp.fromDate(date),
                        createdAt: firebase.firestore.FieldValue.serverTimestamp()
                    });
                    
                    // Log the action
                    await logHistory('Added reminder', `Added reminder: ${title}`, {
                        title: title,
                        description: description,
                        date: dateStr
                    });
                }
                
                closeModal('reminderModal');
                loadReminders();
            } catch (error) {
                console.error('Error saving reminder:', error);
                alert('Error saving reminder. Please try again.');
            }
        }
        
        async function deleteReminder(id, title) {
            openConfirmationModal('Are you sure you want to delete this reminder?', async () => {
                try {
                    await db.collection('reminders').doc(id).delete();
                    
                    // Log the action
                    await logHistory('Deleted reminder', `Deleted reminder: ${title}`);
                    
                    loadReminders();
                } catch (error) {
                    console.error('Error deleting reminder:', error);
                    alert('Error deleting reminder. Please try again.');
                }
            });
        }
        
        // Settings Functions
        function openChangePasswordModal() {
            openModal('changePasswordModal');
        }
        
        function openChangeUsernameModal() {
            const newUsername = prompt('Enter new username:');
            if (newUsername && newUsername.trim() !== '') {
                changeUsername(newUsername.trim());
            }
        }
        
        function openQuickLogoutModal() {
            const password = prompt('Enter your password to sign out from all devices:');
            if (password) {
                quickLogout(password);
            }
        }
        
        async function changePassword() {
            const currentPassword = document.getElementById('current-password').value;
            const newPassword = document.getElementById('new-password').value;
            const confirmNewPassword = document.getElementById('confirm-new-password').value;
            
            if (!currentPassword || !newPassword || !confirmNewPassword) {
                alert('Please fill in all fields.');
                return;
            }
            
            if (newPassword !== confirmNewPassword) {
                alert('New passwords do not match.');
                return;
            }
            
            try {
                // Reauthenticate user
                const credential = firebase.auth.EmailAuthProvider.credential(
                    currentUser.email, 
                    currentPassword
                );
                await currentUser.reauthenticateWithCredential(credential);
                
                // Update password
                await currentUser.updatePassword(newPassword);
                
                // Log the action
                await logHistory('Changed password', 'User changed their portal password');
                
                alert('Password changed successfully!');
                closeModal('changePasswordModal');
            } catch (error) {
                console.error('Error changing password:', error);
                alert('Error changing password. Please check your current password and try again.');
            }
        }
        
        async function changeUsername(newUsername) {
            try {
                // Update user profile
                await currentUser.updateProfile({
                    displayName: newUsername
                });
                
                // Update user document in Firestore
                await db.collection('users').doc(currentUser.uid).update({
                    username: newUsername
                });
                
                // Update UI
                document.getElementById('userGreeting').innerHTML = `<i class="fas fa-user"></i><span>Hi, ${newUsername}! 🎉</span>`;
                
                // Log the action
                await logHistory('Changed username', `Changed username to ${newUsername}`);
                
                alert('Username changed successfully!');
            } catch (error) {
                console.error('Error changing username:', error);
                alert('Error changing username. Please try again.');
            }
        }
        
        async function quickLogout(password) {
            try {
                // Reauthenticate user
                const credential = firebase.auth.EmailAuthProvider.credential(
                    currentUser.email, 
                    password
                );
                await currentUser.reauthenticateWithCredential(credential);
                
                // In a real implementation, you would update a flag in Firestore
                // that other devices check to automatically log out
                // For this demo, we'll just show a success message
                alert('Quick sign out initiated. All other devices will be signed out within 20 seconds.');
                
                // Log the action
                await logHistory('Quick sign out', 'User initiated quick sign out from all devices');
            } catch (error) {
                console.error('Error during quick sign out:', error);
                alert('Error during quick sign out. Please check your password and try again.');
            }
        }
        
        // Clipboard Sync Functions
        async function sendClipboard() {
            try {
                // Get clipboard content (this would need proper permissions in a real app)
                const clipboardText = await navigator.clipboard.readText();
                
                // Save to Firestore
                await db.collection('clipboard').doc(currentUser.uid).set({
                    content: clipboardText,
                    timestamp: firebase.firestore.FieldValue.serverTimestamp()
                });
                
                // Update preview
                document.getElementById('clipboardPreview').textContent = clipboardText;
                document.getElementById('clipboardPreview').classList.add('has-data');
                
                // Show web-based notification instead of browser notification
                showClipboardNotification('Clipboard content sent successfully!', true);
                
                // Update button text and style
                const sendBtn = document.getElementById('sendClipboardBtn');
                const originalText = sendBtn.innerHTML;
                sendBtn.innerHTML = '<i class="fas fa-check"></i> Clipboard Sent';
                sendBtn.classList.add('button-success');
                
                setTimeout(() => {
                    sendBtn.innerHTML = originalText;
                    sendBtn.classList.remove('button-success');
                }, 2000);
            } catch (error) {
                console.error('Error sending clipboard:', error);
                showClipboardNotification('Error sending clipboard content. Please try again.', false);
            }
        }
        
        async function receiveClipboard() {
            try {
                // Get clipboard content from Firestore
                const doc = await db.collection('clipboard').doc(currentUser.uid).get();
                
                if (doc.exists) {
                    const data = doc.data();
                    
                    // Update preview
                    document.getElementById('clipboardPreview').textContent = data.content;
                    document.getElementById('clipboardPreview').classList.add('has-data');
                    
                    // Copy to clipboard
                    await navigator.clipboard.writeText(data.content);
                    
                    // Show web-based notification instead of browser notification
                    showClipboardNotification('Clipboard content received and copied to your clipboard!', true);
                    
                    // Update button text and style
                    const receiveBtn = document.getElementById('receiveClipboardBtn');
                    const originalText = receiveBtn.innerHTML;
                    receiveBtn.innerHTML = '<i class="fas fa-check"></i> Clipboard Received';
                    receiveBtn.classList.add('button-success');
                    
                    setTimeout(() => {
                        receiveBtn.innerHTML = originalText;
                        receiveBtn.classList.remove('button-success');
                    }, 2000);
                } else {
                    showClipboardNotification('No clipboard content available to receive.', false);
                }
            } catch (error) {
                console.error('Error receiving clipboard:', error);
                showClipboardNotification('Error receiving clipboard content. Please try again.', false);
            }
        }
        
        // Clipboard Notification Functions
        function showClipboardNotification(message, isSuccess) {
            const notification = document.getElementById('clipboardNotification');
            const notificationText = document.getElementById('clipboardNotificationText');
            const icon = notification.querySelector('i');
            
            notificationText.textContent = message;
            
            // Set appropriate class and icon
            notification.className = 'clipboard-notification';
            if (isSuccess) {
                notification.classList.add('success');
                icon.className = 'fas fa-check-circle';
            } else {
                notification.classList.add('error');
                icon.className = 'fas fa-exclamation-circle';
            }
            
            // Show notification
            notification.classList.add('show');
            
            // Hide after 3 seconds
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }
        
        function animateButton(buttonId) {
            const button = document.getElementById(buttonId);
            button.classList.add('animate-pulse');
            
            setTimeout(() => {
                button.classList.remove('animate-pulse');
            }, 500);
        }
        
        // Reminders Functions
        async function loadReminders() {
            try {
                const snapshot = await db.collection('reminders')
                    .where('userId', '==', currentUser.uid)
                    .orderBy('date', 'asc')
                    .get();
                
                reminders = [];
                snapshot.forEach(doc => {
                    const data = doc.data();
                    reminders.push({
                        id: doc.id,
                        ...data
                    });
                });
                
                // For demo purposes, if no reminders, add some sample data
                if (reminders.length === 0) {
                    const today = new Date();
                    const tomorrow = new Date(today);
                    tomorrow.setDate(tomorrow.getDate() + 1);
                    
                    // Add sample reminders to Firestore
                    await db.collection('reminders').add({
                        userId: currentUser.uid,
                        title: 'Team Meeting',
                        description: 'Weekly team sync',
                        date: firebase.firestore.Timestamp.fromDate(today),
                        createdAt: firebase.firestore.FieldValue.serverTimestamp()
                    });
                    
                    // Reload reminders
                    loadReminders();
                    return;
                }
                
                filterReminders('today');
                updateDashboardStats();
            } catch (error) {
                console.error('Error loading reminders:', error);
            }
        }
        
        function filterReminders(filter) {
            const remindersList = document.getElementById('remindersList');
            const header = document.getElementById('remindersHeader');
            
            let filteredReminders = [];
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            
            if (filter === 'today') {
                filteredReminders = reminders.filter(reminder => {
                    const reminderDate = reminder.date.toDate();
                    reminderDate.setHours(0, 0, 0, 0);
                    return reminderDate.getTime() === today.getTime();
                });
                
                if (filteredReminders.length === 0) {
                    header.innerHTML = '<i class="fas fa-info-circle"></i> There is no reminder for today!';
                } else {
                    header.innerHTML = `<i class="fas fa-info-circle"></i> You have ${filteredReminders.length} reminder(s) for today!`;
                }
            } else if (filter === 'upcoming') {
                filteredReminders = reminders.filter(reminder => {
                    const reminderDate = reminder.date.toDate();
                    reminderDate.setHours(0, 0, 0, 0);
                    return reminderDate.getTime() > today.getTime();
                });
                
                if (filteredReminders.length === 0) {
                    header.innerHTML = '<i class="fas fa-info-circle"></i> There are no upcoming reminders!';
                } else {
                    const nextReminder = filteredReminders[0];
                    const nextDate = nextReminder.date.toDate().toLocaleDateString();
                    header.innerHTML = `<i class="fas fa-arrow-up" style="color: var(--primary);"></i> <em style="color: var(--text-secondary);">The Upcoming Reminder: ${nextReminder.title} (${nextDate})</em>`;
                }
            } else {
                filteredReminders = [...reminders];
                header.innerHTML = '<i class="fas fa-bell"></i> All Reminders';
            }
            
            renderReminders(filteredReminders);
        }
        
        function renderReminders(remindersToRender) {
            const container = document.getElementById('remindersList');
            container.innerHTML = '';
            
            if (remindersToRender.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-bell"></i>
                        <h3>No Reminders</h3>
                        <p>Click the + button to add your first reminder</p>
                    </div>
                `;
                return;
            }
            
            remindersToRender.forEach(reminder => {
                const reminderItem = document.createElement('div');
                reminderItem.className = 'reminder-item';
                
                const reminderDate = reminder.date.toDate();
                const formattedDate = reminderDate.toLocaleDateString();
                
                reminderItem.innerHTML = `
                    <div class="reminder-content">
                        <div class="reminder-title">${reminder.title}</div>
                        ${reminder.description ? `<div class="reminder-remarks">${reminder.description}</div>` : ''}
                        <div class="reminder-date">${formattedDate}</div>
                    </div>
                    <div class="reminder-actions">
                        <button class="action-btn edit-reminder" data-id="${reminder.id}">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="action-btn delete-reminder" data-id="${reminder.id}" data-name="${reminder.title}">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                `;
                
                container.appendChild(reminderItem);
            });
            
            // Add event listeners for the new elements
            document.querySelectorAll('.edit-reminder').forEach(btn => {
                btn.addEventListener('click', () => {
                    const reminderId = btn.dataset.id;
                    const reminder = reminders.find(r => r.id === reminderId);
                    openReminderModal(reminder);
                });
            });
            
            document.querySelectorAll('.delete-reminder').forEach(btn => {
                btn.addEventListener('click', () => {
                    const reminderId = btn.dataset.id;
                    const reminderTitle = btn.dataset.name;
                    deleteReminder(reminderId, reminderTitle);
                });
            });
        }
        
        // Confirmation Modal Functions
        function openConfirmationModal(message, confirmCallback) {
            document.getElementById('confirmationText').textContent = message;
            openModal('confirmationModal');
            
            // Set up confirm action
            document.getElementById('confirmActionBtn').onclick = () => {
                closeModal('confirmationModal');
                confirmCallback();
            };
        }
        
        // Data Loading Functions
        async function loadUserData() {
            await loadUserPreferences();
            await loadPasswords();
            await loadNotes();
            await loadReminders();
            await loadHistory();
        }
        
        async function loadUserPreferences() {
            try {
                const prefsDoc = await db.collection('userPreferences').doc(currentUser.uid).get();
                
                if (prefsDoc.exists) {
                    const prefs = prefsDoc.data();
                    
                    // Set theme
                    if (prefs.theme) {
                        document.getElementById('themeSelect').value = prefs.theme;
                        changeTheme();
                    }
                    
                    // Set password visibility
                    if (prefs.showPasswords) {
                        document.getElementById('showPasswordsToggle').checked = true;
                        showPasswords = true;
                    }
                }
            } catch (error) {
                console.error('Error loading user preferences:', error);
            }
        }
        
        async function loadPasswords() {
            try {
                const snapshot = await db.collection('passwords')
                    .where('userId', '==', currentUser.uid)
                    .orderBy('createdAt', 'desc')
                    .get();
                
                passwords = [];
                snapshot.forEach(doc => {
                    passwords.push({
                        id: doc.id,
                        ...doc.data()
                    });
                });
                
                renderPasswords();
                updateDashboardStats();
            } catch (error) {
                console.error('Error loading passwords:', error);
            }
        }
        
        function renderPasswords() {
            const container = document.getElementById('passwordsContainer');
            container.innerHTML = '';
            
            if (passwords.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-key"></i>
                        <h3>No Passwords Saved</h3>
                        <p>Click the + button to add your first password</p>
                    </div>
                `;
                return;
            }
            
            passwords.forEach(password => {
                const passwordCard = document.createElement('div');
                passwordCard.className = 'card';
                
                passwordCard.innerHTML = `
                    <div class="card-header">
                        <h3 class="card-title">${password.platformName}</h3>
                        <div class="card-actions">
                            <button class="action-btn edit-password" data-id="${password.id}">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="action-btn delete-password" data-id="${password.id}" data-name="${password.platformName}">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                    ${password.username ? `
                    <div class="card-field">
                        <div class="field-label">Username</div>
                        <div class="field-value" data-value="${password.username}">
                            <span class="field-text">${password.username}</span>
                            <button class="copy-btn" data-value="${password.username}">
                                <i class="far fa-copy"></i>
                            </button>
                        </div>
                    </div>
                    ` : ''}
                    <div class="card-field">
                        <div class="field-label">Password</div>
                        <div class="field-value" data-value="${password.password1}">
                            <span class="field-text">${showPasswords ? password.password1 : '••••••••'}</span>
                            <button class="copy-btn" data-value="${password.password1}">
                                <i class="far fa-copy"></i>
                            </button>
                        </div>
                    </div>
                    ${password.password2 ? `
                    <div class="card-field">
                        <div class="field-label">Second Password</div>
                        <div class="field-value" data-value="${password.password2}">
                            <span class="field-text">${showPasswords ? password.password2 : '••••••••'}</span>
                            <button class="copy-btn" data-value="${password.password2}">
                                <i class="far fa-copy"></i>
                            </button>
                        </div>
                    </div>
                    ` : ''}
                `;
                
                container.appendChild(passwordCard);
            });
            
            // Add event listeners for the new elements
            document.querySelectorAll('.edit-password').forEach(btn => {
                btn.addEventListener('click', () => {
                    const passwordId = btn.dataset.id;
                    const password = passwords.find(p => p.id === passwordId);
                    openPasswordModal(password);
                });
            });
            
            document.querySelectorAll('.delete-password').forEach(btn => {
                btn.addEventListener('click', () => {
                    const passwordId = btn.dataset.id;
                    const platformName = btn.dataset.name;
                    deletePassword(passwordId, platformName);
                });
            });
            
            document.querySelectorAll('.copy-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const value = this.dataset.value;
                    copyToClipboard(value);
                    
                    // Show feedback
                    const originalIcon = this.innerHTML;
                    this.innerHTML = '<i class="fas fa-check"></i>';
                    setTimeout(() => {
                        this.innerHTML = originalIcon;
                    }, 2000);
                });
            });
            
            // Add click event to field values for copying
            document.querySelectorAll('.field-value').forEach(field => {
                field.addEventListener('click', function() {
                    const value = this.dataset.value;
                    if (value) {
                        copyToClipboard(value);
                        
                        // Show feedback
                        const copyBtn = this.querySelector('.copy-btn');
                        if (copyBtn) {
                            const originalIcon = copyBtn.innerHTML;
                            copyBtn.innerHTML = '<i class="fas fa-check"></i>';
                            setTimeout(() => {
                                copyBtn.innerHTML = originalIcon;
                            }, 2000);
                        }
                    }
                });
            });
        }
        
        async function loadNotes() {
            try {
                const snapshot = await db.collection('notes')
                    .where('userId', '==', currentUser.uid)
                    .orderBy('createdAt', 'desc')
                    .get();
                
                notes = [];
                snapshot.forEach(doc => {
                    notes.push({
                        id: doc.id,
                        ...doc.data()
                    });
                });
                
                renderNotes();
                updateDashboardStats();
            } catch (error) {
                console.error('Error loading notes:', error);
            }
        }
        
        function renderNotes() {
            const container = document.getElementById('notesContainer');
            container.innerHTML = '';
            
            if (notes.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-sticky-note"></i>
                        <h3>No Notes Created</h3>
                        <p>Click the + button to add your first note</p>
                    </div>
                `;
                return;
            }
            
            notes.forEach(note => {
                const noteCard = document.createElement('div');
                noteCard.className = `note-card ${note.color}`;
                
                // Truncate content if too long
                const content = note.content.length > 150 ? 
                    note.content.substring(0, 150) + '...' : 
                    note.content;
                
                noteCard.innerHTML = `
                    <div class="card-header">
                        <h3 class="note-title">${note.title}</h3>
                        <div class="card-actions">
                            <button class="action-btn edit-note" data-id="${note.id}">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="action-btn delete-note" data-id="${note.id}" data-name="${note.title}">
                                <i class="fas fa-trash"></i>
                            </button>
                            <button class="action-btn copy-note" data-content="${note.content}">
                                <i class="far fa-copy"></i>
                            </button>
                        </div>
                    </div>
                    <div class="note-content">
                        ${content.replace(/\n/g, '<br>')}
                    </div>
                    ${note.content.length > 150 ? `
                    <div class="read-more">Read more</div>
                    ` : ''}
                `;
                
                container.appendChild(noteCard);
            });
            
            // Add event listeners for the new elements
            document.querySelectorAll('.edit-note').forEach(btn => {
                btn.addEventListener('click', () => {
                    const noteId = btn.dataset.id;
                    const note = notes.find(n => n.id === noteId);
                    openNoteModal(note);
                });
            });
            
            document.querySelectorAll('.delete-note').forEach(btn => {
                btn.addEventListener('click', () => {
                    const noteId = btn.dataset.id;
                    const noteTitle = btn.dataset.name;
                    deleteNote(noteId, noteTitle);
                });
            });
            
            document.querySelectorAll('.copy-note').forEach(btn => {
                btn.addEventListener('click', function() {
                    const content = this.dataset.content;
                    copyToClipboard(content);
                    
                    // Show feedback
                    const originalIcon = this.innerHTML;
                    this.innerHTML = '<i class="fas fa-check"></i>';
                    setTimeout(() => {
                        this.innerHTML = originalIcon;
                    }, 2000);
                });
            });
            
            document.querySelectorAll('.read-more').forEach(btn => {
                btn.addEventListener('click', function() {
                    const noteContent = this.previousElementSibling;
                    const isExpanded = noteContent.classList.contains('expanded');
                    
                    if (isExpanded) {
                        noteContent.classList.remove('expanded');
                        this.textContent = 'Read more';
                    } else {
                        // Get the full note content
                        const noteId = this.closest('.note-card').querySelector('.edit-note').dataset.id;
                        const note = notes.find(n => n.id === noteId);
                        
                        if (note) {
                            noteContent.innerHTML = note.content.replace(/\n/g, '<br>');
                            noteContent.classList.add('expanded');
                            this.textContent = 'Read less';
                        }
                    }
                });
            });
            
            // Add click event to note title/content to open popup
            document.querySelectorAll('.note-title, .note-content').forEach(element => {
                element.style.cursor = 'pointer';
                element.addEventListener('click', function() {
                    const noteCard = this.closest('.note-card');
                    const noteId = noteCard.querySelector('.edit-note').dataset.id;
                    const note = notes.find(n => n.id === noteId);
                    
                    if (note) {
                        openNotePopup(note);
                    }
                });
            });
        }
        
        async function loadHistory() {
            try {
                const snapshot = await db.collection('history')
                    .where('userId', '==', currentUser.uid)
                    .orderBy('timestamp', 'desc')
                    .limit(HISTORY_PER_PAGE)
                    .get();
                
                history = [];
                snapshot.forEach(doc => {
                    history.push({
                        id: doc.id,
                        ...doc.data()
                    });
                });
                
                renderHistory();
                
                // Show/hide load more button
                document.getElementById('loadMoreHistory').style.display = 
                    history.length === HISTORY_PER_PAGE ? 'block' : 'none';
                    
                updateDashboardStats();
            } catch (error) {
                console.error('Error loading history:', error);
            }
        }
        
        async function loadMoreHistory() {
            try {
                currentHistoryPage++;
                
                const snapshot = await db.collection('history')
                    .where('userId', '==', currentUser.uid)
                    .orderBy('timestamp', 'desc')
                    .limit(HISTORY_PER_PAGE * (currentHistoryPage + 1))
                    .get();
                
                history = [];
                snapshot.forEach(doc => {
                    history.push({
                        id: doc.id,
                        ...doc.data()
                    });
                });
                
                renderHistory();
                
                // Show/hide load more button
                document.getElementById('loadMoreHistory').style.display = 
                    history.length === HISTORY_PER_PAGE * (currentHistoryPage + 1) ? 'block' : 'none';
            } catch (error) {
                console.error('Error loading more history:', error);
            }
        }
        
        function renderHistory() {
            const container = document.getElementById('historyContainer');
            container.innerHTML = '';
            
            if (history.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-history"></i>
                        <h3>No Activity History</h3>
                        <p>Your activity will appear here</p>
                    </div>
                `;
                return;
            }
            
            // Only show the first HISTORY_PER_PAGE * (currentHistoryPage + 1) items
            const itemsToShow = history.slice(0, HISTORY_PER_PAGE * (currentHistoryPage + 1));
            
            itemsToShow.forEach(log => {
                const historyItem = document.createElement('div');
                historyItem.className = 'history-item';
                
                // Format timestamp
                const timestamp = log.timestamp ? 
                    new Date(log.timestamp.toDate()).toLocaleString() : 
                    'Unknown time';
                
                historyItem.innerHTML = `
                    <div class="history-header">
                        <span class="history-action">${log.action}</span>
                        <span class="history-time">${timestamp}</span>
                    </div>
                    <div class="history-details">${log.details}</div>
                    ${log.data ? `
                    <button class="view-more-btn" data-id="${log.id}">
                        <i class="fas fa-chevron-down"></i> View Details
                    </button>
                    <div class="history-details-full" id="details-${log.id}">
                        ${generateHistoryDetails(log)}
                    </div>
                    ` : ''}
                `;
                
                container.appendChild(historyItem);
            });
            
            // Add event listeners for view more buttons
            document.querySelectorAll('.view-more-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const detailsId = this.dataset.id;
                    const detailsElement = document.getElementById(`details-${detailsId}`);
                    
                    if (detailsElement.classList.contains('show')) {
                        detailsElement.classList.remove('show');
                        this.innerHTML = '<i class="fas fa-chevron-down"></i> View Details';
                    } else {
                        detailsElement.classList.add('show');
                        this.innerHTML = '<i class="fas fa-chevron-up"></i> Hide Details';
                    }
                });
            });
        }
        
        function generateHistoryDetails(log) {
            // Generate detailed history information from actual data
            if (!log.data) return '';
            
            let details = '';
            
            if (log.action.includes('password')) {
                details += `Platform: ${log.data.platformName || 'N/A'}\n`;
                details += `Username: ${log.data.username || 'N/A'}\n`;
                
                if (log.data.oldPassword && log.data.newPassword) {
                    details += `Old Password: ${log.data.oldPassword}\n`;
                    details += `New Password: ${log.data.newPassword}\n`;
                } else if (log.data.password1) {
                    details += `Password: ${log.data.password1}\n`;
                }
                
                if (log.data.oldPassword2 || log.data.password2) {
                    details += `Second Password: ${log.data.oldPassword2 || log.data.password2 || 'N/A'}\n`;
                }
            } else if (log.action.includes('note')) {
                details += `Title: ${log.data.title || 'N/A'}\n`;
                
                if (log.data.oldContent && log.data.newContent) {
                    details += `Old Content: ${log.data.oldContent}\n`;
                    details += `New Content: ${log.data.newContent}\n`;
                } else if (log.data.content) {
                    details += `Content: ${log.data.content}\n`;
                }
                
                details += `Color: ${log.data.color || 'default'}\n`;
            } else if (log.action.includes('reminder')) {
                details += `Title: ${log.data.title || 'N/A'}\n`;
                details += `Description: ${log.data.description || 'N/A'}\n`;
                details += `Date: ${log.data.date || 'N/A'}\n`;
            }
            
            return details;
        }
        
        // Utility Functions
        async function logHistory(action, details, data = null) {
            try {
                await db.collection('history').add({
                    userId: currentUser.uid,
                    action: action,
                    details: details,
                    data: data,
                    timestamp: firebase.firestore.FieldValue.serverTimestamp()
                });
                
                // Reload history to show the new entry
                loadHistory();
            } catch (error) {
                console.error('Error logging history:', error);
            }
        }
        
        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                // Success feedback is handled in the event listener
            }).catch(err => {
                console.error('Failed to copy text: ', err);
            });
        }
        
        // Workflow Tab Functions
        function initializeWorkflowTab() {
            renderWorkflowTools();
            updateWorkflowDateInfo();
            
            // Load workflow settings
            const savedOpenInNewTab = localStorage.getItem('workflowOpenInNewTab');
            if (savedOpenInNewTab === 'true') {
                document.getElementById('workflowOpenNewTab').checked = true;
            } else {
                document.getElementById('workflowOpenNewTab').checked = false;
            }
        }
        
        function renderWorkflowTools() {
            const container = document.getElementById('workflowToolsGrid');
            container.innerHTML = '';
            
            workflowTools.forEach(tool => {
                const toolCard = document.createElement('div');
                toolCard.className = 'workflow-tool-card';
                toolCard.onclick = () => openWorkflowTool(tool.url);
                
                toolCard.innerHTML = `
                    <div class="workflow-tool-icon">
                        <i class="${tool.icon}"></i>
                    </div>
                    <h3 class="workflow-tool-title">${tool.name}</h3>
                    <p class="workflow-tool-desc">${tool.description}</p>
                `;
                
                container.appendChild(toolCard);
            });
        }
        
        function openWorkflowTool(url) {
            const openInNewTab = document.getElementById('workflowOpenNewTab').checked;
            
            if (openInNewTab) {
                window.open(url, '_blank');
            } else {
                window.location.href = url;
            }
        }
        
        function updateWorkflowDateInfo() {
            const today = new Date();
            today.setHours(0, 0, 0, 0); // Normalize to start of day
            
            // Calculate dates
            const rolloverDate = new Date(today);
            rolloverDate.setDate(today.getDate() - 29);
            
            const mbbDate = new Date(today);
            mbbDate.setDate(today.getDate() - 31);
            
            const prepaidDate = new Date(today);
            prepaidDate.setDate(today.getDate() - 20);
            
            const huntingDate = new Date(today);
            huntingDate.setDate(today.getDate() - 10);
            
            // Format dates
            const formatDate = (date) => {
                const options = { day: 'numeric', month: 'short', year: 'numeric' };
                return date.toLocaleDateString('en-PK', options).replace(/(\d+)\s(\w+)\s(\d+)/, '$1/$2/$3');
            };
            
            // Update UI
            const container = document.getElementById('workflowDateInfo');
            container.innerHTML = `
                <div class="workflow-date-item rollover">
                    <span class="workflow-date-label">Rollover Date</span>
                    <span class="workflow-date-value">${formatDate(rolloverDate)}</span>
                </div>
                <div class="workflow-date-item mbb">
                    <span class="workflow-date-label">MBB Date</span>
                    <span class="workflow-date-value">${formatDate(mbbDate)}</span>
                </div>
                <div class="workflow-date-item prepaid">
                    <span class="workflow-date-label">20 Days Prepaid Open</span>
                    <span class="workflow-date-value">${formatDate(prepaidDate)}</span>
                </div>
                <div class="workflow-date-item hunting">
                    <span class="workflow-date-label">11th day Hunting</span>
                    <span class="workflow-date-value">${formatDate(huntingDate)}</span>
                </div>
            `;
        }
        
        // Add modal click handlers
        document.querySelectorAll('.modal-overlay, .note-popup').forEach(modal => {
            modal.addEventListener('click', handleModalClick);
        });
    </script>
</body>
</html>
